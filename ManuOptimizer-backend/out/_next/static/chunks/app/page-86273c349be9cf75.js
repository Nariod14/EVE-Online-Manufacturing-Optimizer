(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{285:(e,t,a)=>{"use strict";a.d(t,{$:()=>o});var s=a(5155);a(2115);var l=a(9708),r=a(2085),n=a(9434);let i=(0,r.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:a,size:r,asChild:o=!1,...d}=e,c=o?l.DX:"button";return(0,s.jsx)(c,{"data-slot":"button",className:(0,n.cn)(i({variant:a,size:r,className:t})),...d})}},356:(e,t,a)=>{"use strict";a.d(t,{C:()=>o,z:()=>i});var s=a(5155);a(2115);var l=a(7701),r=a(9428),n=a(9434);function i(e){let{className:t,...a}=e;return(0,s.jsx)(l.bL,{"data-slot":"radio-group",className:(0,n.cn)("grid gap-3",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)(l.q7,{"data-slot":"radio-group-item",className:(0,n.cn)("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,s.jsx)(l.C1,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,s.jsx)(r.A,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}},373:(e,t,a)=>{Promise.resolve().then(a.bind(a,6671)),Promise.resolve().then(a.bind(a,2530)),Promise.resolve().then(a.bind(a,947)),Promise.resolve().then(a.bind(a,1222)),Promise.resolve().then(a.bind(a,2068)),Promise.resolve().then(a.bind(a,4886))},549:(e,t,a)=>{"use strict";a.d(t,{$m:()=>d,As:()=>o,nD:()=>i,ub:()=>c});var s=a(5155);a(2115);var l=a(3478),r=a(6474),n=a(9434);function i(e){let{...t}=e;return(0,s.jsx)(l.bL,{"data-slot":"accordion",...t})}function o(e){let{className:t,...a}=e;return(0,s.jsx)(l.q7,{"data-slot":"accordion-item",className:(0,n.cn)("border-b last:border-b-0",t),...a})}function d(e){let{className:t,children:a,...i}=e;return(0,s.jsx)(l.Y9,{className:"flex",children:(0,s.jsxs)(l.l9,{"data-slot":"accordion-trigger",className:(0,n.cn)("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",t),...i,children:[a,(0,s.jsx)(r.A,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function c(e){let{className:t,children:a,...r}=e;return(0,s.jsx)(l.UC,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...r,children:(0,s.jsx)("div",{className:(0,n.cn)("pt-0 pb-4",t),children:a})})}},947:(e,t,a)=>{"use strict";a.d(t,{default:()=>E});var s=a(5155),l=a(2115),r=a(549),n=a(285),i=a(2523),o=a(6671),d=a(6474),c=a(7863),u=a(9917),x=a(2525),m=a(133),b=a(6695),h=a(6021);function p(e){return e.toLocaleString()+" ISK"}function g(e){let{materials:t}=e;if(!t||0===t.length)return(0,s.jsx)("div",{className:"text-gray-400 italic",children:"No materials"});let a=t.reduce((e,t)=>{if(!t)return e;let a=t.category||"Other";return e[a]||(e[a]={}),e[a][t.name]=t.quantity,e},{});return(0,s.jsx)("ul",{className:"list-none pl-0 m-0 text-xs",children:Object.entries(a).map(e=>{let[t,a]=e;return(0,s.jsxs)("li",{children:[(0,s.jsx)("span",{className:"font-semibold",children:t}),(0,s.jsx)("ul",{className:"list-none pl-3",children:Object.entries(a).map(e=>{let[t,a]=e;return(0,s.jsxs)("li",{children:[(0,s.jsx)("span",{className:"text-accent",children:t}),": ",a]},t)})})]},t)})})}function f(e){let{blueprints:t,onEdit:a,onSetBlueprints:f,loading:j,fetchBlueprints:v}=e,[y,N]=(0,l.useState)({}),[w,C]=(0,l.useState)({}),[_,S]=(0,l.useState)({key:"name",direction:"asc"}),[k,T]=(0,l.useState)({key:"name",direction:"asc"}),[E,F]=(0,l.useState)("");function O(e){return"T2"===e.tier}!function(){let[e,t]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(window.__msw)t(!0);else{let e=setInterval(()=>{window.__msw&&(clearInterval(e),t(!0))},50)}},[])}(),(0,l.useEffect)(()=>{null==v||v()},[]);let M=async e=>{window.confirm("Are you sure you want to delete this blueprint?")&&((await fetch("/api/blueprints/blueprint/".concat(e),{method:"DELETE"})).ok?(o.o.success("Blueprint deleted"),null==v||v()):o.o.error("Failed to delete blueprint"))},P=async e=>{if(!f)return;console.log("Resetting max value for blueprint",e);let t=await fetch("/api/blueprints/blueprint/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({max:null})});t.ok?(f(t=>t.map(t=>t.id===e?{...t,max:null}:t)),N(t=>{let a={...t};return delete a[e],a}),console.log("Toast triggered for individual reset"),o.o.success("Blueprint max value reset")):(console.error("Failed to reset max value: "+t.statusText),o.o.error("Failed to reset max value"))},A=async e=>{if(!f)return;C(t=>({...t,[e]:!0})),console.log("Resetting all max values for tier",e);let t=await fetch("/api/blueprints/blueprints/reset_max",{method:"POST"});t.ok?(console.log("All max values reset"),o.o.success("All max values reset"),f(e=>e.map(e=>({...e,max:null}))),N({})):(console.error("Failed to reset all max values"+t.statusText),o.o.error("Failed to reset all max values")),C(t=>({...t,[e]:!1}))},z=(e,t)=>{N(a=>({...a,[e]:t}))},B=async e=>{let t=y[e];if(""===t||null==t)return;let a=parseInt(t,10);isNaN(a)||((await fetch("/api/blueprints/blueprint/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({max:a})})).ok?o.o.success("Max value updated"):o.o.error("Failed to update max value"))};function I(e,t){return[...e].sort((e,a)=>{var s,l,r,n;let i="asc"===t.direction?1:-1;switch(t.key){case"name":return e.name.localeCompare(a.name)*i;case"sell_price":return(e.sell_price-a.sell_price)*i;case"material_cost":return(e.material_cost-a.material_cost)*i;case"full_material_cost":return(("T2"===e.tier?e.full_material_cost:e.material_cost)-("T2"===a.tier?a.full_material_cost:a.material_cost))*i;case"profit":return(e.sell_price-("T2"===e.tier?e.full_material_cost:e.material_cost)-(a.sell_price-("T2"===a.tier?a.full_material_cost:a.material_cost)))*i;case"profit_percent":{let t="T2"===e.tier?e.full_material_cost:e.material_cost,s="T2"===a.tier?a.full_material_cost:a.material_cost;return((t>0?(e.sell_price-t)/t*100:0)-(s>0?(a.sell_price-s)/s*100:0))*i}case"station_name":return((null==(s=e.station)?void 0:s.name)||e.station_name||"Jita 4-4").localeCompare((null==(l=a.station)?void 0:l.name)||a.station_name||"Jita 4-4")*i;case"max":return((null!=(r=e.max)?r:0)-(null!=(n=a.max)?n:0))*i;case"invention_chance":return(("T2"===e.tier?e.invention_chance:0)-("T2"===a.tier?a.invention_chance:0))*i;default:return 0}})}function $(e,t){let a=t.trim().toLowerCase();return a?e.filter(e=>{var t,s,l;let r=e.sell_price,n=e.material_cost,i=r-n,o=n>0?(i/n*100).toFixed(2):"-",d=(null==(t=e.name)?void 0:t.toLowerCase().includes(a))||(null==(s=e.station_name)?void 0:s.toLowerCase().includes(a))||String(r).includes(a)||String(n).includes(a)||String(i).includes(a)||o.includes(a)||String(null!=(l=e.max)?l:"").includes(a),c=!!Array.isArray(e.materials)&&e.materials.some(e=>{var t;return(null==(t=e.name)?void 0:t.toLowerCase().includes(a))||String(e.quantity).includes(a)});if("T2"===e.tier){let t=r-e.full_material_cost,s=e.full_material_cost>0?(t/e.full_material_cost*100).toFixed(2):"-",l=String(e.full_material_cost).includes(a)||String(e.invention_chance).includes(a)||String(t).includes(a)||s.includes(a);return d||l||c}return d||c}):e}let L=t.filter(e=>"T1"===e.tier),J=t.filter(O),R=$(L,E),D=$(J,E);function U(e,t,a,l){return(0,s.jsx)("tr",{className:"T2"===a?"text-orange-400":"text-blue-400",children:e.map(e=>{let a=["name","sell_price","material_cost","full_material_cost","profit","station_name","max","invention_chance"].includes(e.key),r=t.key===e.key;return(0,s.jsx)("th",{className:"py-2 px-3 text-left ".concat(a?"cursor-pointer select-none hover:underline":""),onClick:()=>a&&l({key:e.key,direction:r&&"asc"===t.direction?"desc":"asc"}),children:(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[e.label,a&&r?"asc"===t.direction?(0,s.jsx)(d.A,{className:"w-4 h-4 inline"}):(0,s.jsx)(c.A,{className:"w-4 h-4 inline"}):null]})},e.key)})})}return(0,s.jsxs)(b.Wu,{children:[(0,s.jsx)(b.BT,{children:(0,s.jsx)("div",{className:"mb-4 flex justify-between items-center gap-4",children:(0,s.jsx)(i.p,{type:"text",placeholder:"Search blueprints...",value:E,onChange:e=>F(e.target.value),className:"w-full max-w-md bg-blue-900 text-blue-200 border-blue-700"})})}),(0,s.jsxs)(r.nD,{type:"multiple",className:"mb-4",children:[(0,s.jsxs)(r.As,{value:"t1",defaultChecked:!0,children:[(0,s.jsx)(r.$m,{className:"text-lg font-semibold text-blue-100 bg-gradient-to-r from-blue-800 via-blue-700 to-blue-900 hover:no-underline rounded-t-xl px-4 py-3",style:{borderBottom:"2px solid #60a5fa",boxShadow:"0 2px 8px 0 #2563eb22"},children:(0,s.jsx)("span",{className:"text-blue-200",children:"Tier 1 Blueprints"})}),(0,s.jsx)(r.ub,{className:"bg-gradient-to-br from-blue-950 via-blue- to-slate-950 hover:no-underline rounded-b-xl px-2 pb-4 pt-2",children:R.length?(0,s.jsxs)("div",{className:"overflow-x-auto",children:[(0,s.jsxs)("table",{className:"min-w-full text-sm bg-blue-950/70 rounded-xl shadow",children:[(0,s.jsx)("thead",{children:U([{key:"name",label:"Name"},{key:"sell_price",label:"Sell Price"},{key:"material_cost",label:"Material Cost"},{key:"materials",label:"Materials"},{key:"profit",label:"Profit %"},{key:"station_name",label:"Station"},{key:"max",label:"Max"},{key:"actions",label:"Actions"}],_,"T1",S)}),(0,s.jsx)("tbody",{children:I(R,_).map(e=>{var t,l,r;let o=Math.round(e.sell_price),d=Math.round(e.material_cost),c=o-d,b=d>0?(c/d*100).toFixed(2):"-";return(0,s.jsxs)("tr",{className:"border-b border-blue-800 hover:bg-blue-900/60 text-blue-200 transition",children:[(0,s.jsx)("td",{className:"py-2 px-3 font-semibold",children:e.name}),(0,s.jsxs)("td",{className:"py-2 px-3",children:[p(o)," ",(0,s.jsxs)("span",{className:"text-xs text-blue-400 ml-1",children:["(",(0,h.G)(o)," isk)"]}),e.used_jita_fallback&&(0,s.jsx)("span",{className:"ml-2 text-orange-400",title:"Fallback to Jita pricing",children:"⚠"})]}),(0,s.jsxs)("td",{className:"py-2 px-3",children:[p(d)," ",(0,s.jsxs)("span",{className:"text-xs text-blue-400 ml-1",children:["(",(0,h.G)(d)," isk)"]})]}),(0,s.jsx)("td",{className:"py-2 px-3",children:(0,s.jsx)(g,{materials:e.materials})}),(0,s.jsxs)("td",{className:"py-2 px-3 text-center",children:[b,"%"]}),(0,s.jsx)("td",{className:"py-2 px-3 text-center",children:e.station_name||(null==(t=e.station)?void 0:t.name)||"Jita 4-4"}),(0,s.jsx)("td",{className:"py-2 px-3 text-center",children:(0,s.jsx)(i.p,{type:"number",value:null!=(r=y[e.id])?r:null!=(l=e.max)?l:"",onChange:t=>z(e.id,t.target.value),onBlur:()=>B(e.id),className:"w-16 text-center bg-blue-900 border-blue-700"})}),(0,s.jsx)("td",{className:"py-2 px-3 text-center",children:(0,s.jsxs)("div",{className:"flex flex-col gap-2 items-stretch",children:[(0,s.jsxs)(n.$,{size:"sm",variant:"secondary",className:"bg-blue-700 text-white",onClick:()=>null==a?void 0:a(e,"T1"),children:[(0,s.jsx)(u.A,{className:"w-4 h-4 mr-1"})," Edit"]}),(0,s.jsxs)(h.a,{onDelete:()=>M(e.id),children:[(0,s.jsx)(x.A,{className:"w-4 h-4 mr-1"})," Delete"]}),(0,s.jsxs)(n.$,{size:"sm",variant:"outline",className:"border-blue-500 text-blue-700 bg-blue-200",onClick:()=>P(e.id),children:[(0,s.jsx)(m.A,{className:"w-4 h-4 mr-1"})," Reset Max"]})]})})]},e.id)})})]}),(0,s.jsx)("div",{className:"flex justify-end mt-3",children:(0,s.jsxs)(n.$,{variant:"outline",className:"border-blue-500 text-blue-700 bg-blue-50",onClick:()=>A("T1"),disabled:!!w.T1,children:[(0,s.jsx)(m.A,{className:"w-4 h-4 mr-2"}),w.T1?"Resetting...":"Reset All Max Values"]})})]}):(0,s.jsx)("div",{className:"p-6 text-blue-400",children:"No Tier 1 blueprints found."})})]}),(0,s.jsxs)(r.As,{value:"t2",children:[(0,s.jsx)(r.$m,{className:"text-lg font-semibold bg-gradient-to-r from-orange-400 via-orange-500 to-yellow-500 text-orange-900 hover:no-underline rounded-t-xl px-4 py-3",style:{borderBottom:"2px solid #f59e42",boxShadow:"0 2px 8px 0 #f59e4222"},children:(0,s.jsx)("span",{className:"text-[#fcf2e2]",children:"Tier 2 Blueprints"})}),(0,s.jsx)(r.ub,{className:"bg-[#2d1e13] rounded-b-xl px-2 pb-4 pt-2 border-l-[8px] border-[#ff9800] shadow-[0_4px_20px_0_rgba(200,120,30,0.13)]",children:D.length?(0,s.jsxs)("div",{className:"overflow-x-auto",children:[(0,s.jsxs)("table",{className:"min-w-full text-sm bg-[#2d1e13] rounded-xl shadow",children:[(0,s.jsx)("thead",{children:U([{key:"name",label:"Name"},{key:"invention_chance",label:"Invention Chance %"},{key:"sell_price",label:"Sell Price"},{key:"full_material_cost",label:"Full Material Cost"},{key:"materials",label:"Materials"},{key:"profit",label:"Profit %"},{key:"station_name",label:"Station"},{key:"max",label:"Max"},{key:"actions",label:"Actions"}],k,"T2",T)}),(0,s.jsx)("tbody",{children:I(D,k).map(e=>{if(!O(e))return console.log("Blueprint ".concat(e.id," is not Tier 2!")),null;{var t,l,r,o;e.material_cost;let d=Math.round(e.sell_price),c=Math.round(null!=(l=e.full_material_cost)?l:e.material_cost),b=d-c,f=c>0?(b/c*100).toFixed(2):"-";return(0,s.jsxs)("tr",{className:"border-b border-[#ff9800] hover:bg-[#5a492f] text-amber-100 transition",children:[(0,s.jsx)("td",{className:"py-2 px-3 font-semibold text-[#e8d5b9]",children:e.name}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-[#fff1dc]",children:null!=e.invention_chance?(100*e.invention_chance).toFixed(1)+"%":"-"}),(0,s.jsxs)("td",{className:"py-2 px-3 text-[#ffedd1]",children:[p(d)," ",(0,s.jsxs)("span",{className:"text-xs text-[#d57d00] ml-1",children:["(",(0,h.G)(d)," isk)"]}),e.used_jita_fallback&&(0,s.jsx)("span",{className:"ml-2 text-[#d57d00]",title:"Fallback to Jita pricing",children:"⚠"})]}),(0,s.jsxs)("td",{className:"py-2 px-3 text-[#ffedd1]",children:[p(c)," ",(0,s.jsxs)("span",{className:"text-xs text-[#d57d00] ml-1",children:["(",(0,h.G)(c)," isk)"]})]}),(0,s.jsx)("td",{className:"py-2 px-3",children:(0,s.jsx)(g,{materials:e.materials})}),(0,s.jsxs)("td",{className:"py-2 px-3 text-center text-[#ffeed4]",children:[f,"%"]}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-[#ffedd1]",children:e.station_name||(null==(t=e.station)?void 0:t.name)||"Jita 4-4"}),(0,s.jsx)("td",{className:"py-2 px-3 text-center",children:(0,s.jsx)(i.p,{type:"number",value:null!=(o=y[e.id])?o:null!=(r=e.max)?r:"",onChange:t=>z(e.id,t.target.value),onBlur:()=>B(e.id),className:"w-16 text-center bg-[#3a2719] border-[#e08900] text-[##ffedd1]"})}),(0,s.jsx)("td",{className:"py-2 px-3 text-center",children:(0,s.jsxs)("div",{className:"flex flex-col gap-2 items-stretch",children:[(0,s.jsxs)(n.$,{size:"sm",variant:"secondary",className:"bg-[#e08900] text-white hover:bg-[#f09a00]",onClick:()=>null==a?void 0:a(e,"T2"),children:[(0,s.jsx)(u.A,{className:"w-4 h-4 mr-1"})," Edit"]}),(0,s.jsxs)(h.a,{onDelete:()=>M(e.id),children:[(0,s.jsx)(x.A,{className:"w-4 h-4 mr-1"})," Delete"]}),(0,s.jsxs)(n.$,{size:"sm",variant:"outline",className:"border-[#e08900] text-[#bf7404] bg-amber-100",onClick:()=>P(e.id),children:[(0,s.jsx)(m.A,{className:"w-4 h-4 mr-1"})," Reset Max"]})]})})]},e.id)}})})]}),(0,s.jsx)("div",{className:"flex justify-end mt-3",children:(0,s.jsxs)(n.$,{variant:"outline",className:"border-[#e08900] text-[#ce7c00] bg-amber-50",onClick:()=>A("T2"),disabled:!!w.T2,children:[(0,s.jsx)(m.A,{className:"w-4 h-4 mr-2"}),w.T2?"Resetting...":"Reset All Max Values"]})})]}):(0,s.jsx)("div",{className:"p-6 text-[#d57d00]",children:"No Tier 2 blueprints found."})})]})]}),(0,s.jsxs)("div",{className:"price-legend mt-2 text-sm text-[#ff9500]",children:[(0,s.jsx)("span",{className:"text-orange-400",children:"⚠"})," Fallback to Jita pricing"]})]})}var j=a(4165),v=a(5057),y=a(9409);function N(e){let{open:t,blueprint:a,tier:r,onClose:o,onSave:d}=e,[c,u]=l.useState(null),[x,m]=(0,l.useState)([]);if((0,l.useEffect)(()=>{async function e(){try{let e=await fetch("/api/stations"),t=await e.json();m(t)}catch(e){console.error("Failed to fetch stations:",e)}}t&&e()},[t]),(0,l.useEffect)(()=>{a&&u(a)},[a]),!c)return null;function b(e){let{name:t,value:a}=e.target;u(e=>e?{...e,[t]:"sell_price"===t||"material_cost"===t?parseFloat(a):a}:e)}let h={T1:{modal:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border border-blue-800 shadow-2xl text-white",label:"text-[#a0c4ff] mb-1",input:"bg-slate-800 border border-blue-800 text-white focus:ring-blue-400 focus:border-blue-400",selectTrigger:"bg-slate-800 border border-blue-800 text-white focus:ring-blue-400 focus:border-blue-400",selectContent:"bg-slate-900 text-white",buttonPrimary:"bg-blue-700 hover:bg-blue-500 focus:ring-blue-500 text-white",buttonSecondary:"bg-slate-900 text-blue-300 hover:bg-blue-700",title:"text-blue-300"},T2:{modal:"rounded-2xl bg-gradient-to-br from-yellow-900 via-amber-900 to-orange-950 border border-amber-700 shadow-2xl text-[#f0e4c1]",label:"text-[#f9d58b] mb-1",input:"bg-[#5c3b0d] border border-amber-700 text-[#f0e4c1] focus:ring-amber-400 focus:border-amber-400",selectTrigger:"bg-[#5c3b0d] border border-amber-700 text-[#f0e4c1] focus:ring-amber-400 focus:border-amber-400",selectContent:"bg-[#3e2f0f] text-[#f0e4c1]",buttonPrimary:"bg-amber-700 hover:bg-amber-500 focus:ring-amber-500 text-[#0c0802]",buttonSecondary:"bg-[#3b2e08] text-amber-500 hover:bg-amber-900",title:"text-amber-400"}}[c.tier||"T1"];return(0,s.jsx)(j.lG,{open:t,onOpenChange:e=>!e&&o(),children:(0,s.jsxs)(j.Cf,{className:"max-w-lg rounded-lg shadow-lg overflow-hidden ".concat(h.modal),children:[(0,s.jsx)(j.c7,{children:(0,s.jsx)(j.L3,{className:"text-2xl font-semibold ".concat(h.title),children:"Edit Blueprint"})}),(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),c&&d(c)},className:"space-y-6 overflow-x-hidden",children:[(0,s.jsx)(i.p,{type:"hidden",name:"id",value:c.id}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"editBlueprintName",className:h.label,children:"Blueprint Name"}),(0,s.jsx)(i.p,{id:"editBlueprintName",name:"name",value:c.name,onChange:b,required:!0,className:"".concat(h.input," w-full")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"editBlueprintSellPrice",className:h.label,children:"Sell Price"}),(0,s.jsx)(i.p,{id:"editBlueprintSellPrice",name:"sell_price",type:"number",step:"0.01",value:c.sell_price,onChange:b,required:!0,className:"".concat(h.input," w-full")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"editBlueprintCost",className:h.label,children:"Material Cost"}),(0,s.jsx)(i.p,{id:"editBlueprintCost",name:"material_cost",type:"number",step:"0.01",value:c.material_cost,onChange:b,required:!0,className:"".concat(h.input," w-full")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"editBlueprintStation",className:h.label,children:"Manufacturing Station"}),(0,s.jsxs)("select",{id:"editBlueprintStation",name:"station_id",value:c.station_id||"",onChange:b,className:"".concat(h.input," w-full rounded-md py-2 px-1.5"),children:[(0,s.jsx)("option",{value:"",children:"None (Use Jita)"}),x.map(e=>(0,s.jsxs)("option",{value:e.station_id,children:[e.name," (",e.station_id,")"]},e.station_id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"editBlueprintTier",className:h.label,children:"Tier"}),(0,s.jsxs)(y.l6,{value:c.tier,onValueChange:function(e){u(t=>{if(!t)return t;if("T2"===e)return"T1"===t.tier?{...t,tier:"T2",invention_chance:0,invention_cost:0,full_material_cost:t.material_cost,runs_per_copy:10}:t;if("T2"===t.tier){let{invention_chance:e,invention_cost:a,full_material_cost:s,runs_per_copy:l,...r}=t;return{...r,tier:"T1"}}return t})},children:[(0,s.jsx)(y.bq,{id:"editBlueprintTier",className:"".concat(h.selectTrigger," w-full"),children:(0,s.jsx)(y.yv,{})}),(0,s.jsxs)(y.gC,{className:h.selectContent,children:[(0,s.jsx)(y.eb,{value:"T1",children:"Tier 1"}),(0,s.jsx)(y.eb,{value:"T2",children:"Tier 2"})]})]})]}),"T2"===c.tier&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"editBlueprintInventionChance",className:h.label,children:"Invention Chance (%)"}),(0,s.jsx)(i.p,{id:"editBlueprintInventionChance",name:"invention_chance",type:"number",min:0,max:100,step:.1,value:c.invention_chance?100*c.invention_chance:"",onChange:function(e){let t=e.target.value;u(e=>e&&"T2"===e.tier?{...e,invention_chance:t?parseFloat(t)/100:0}:e)},className:"".concat(h.input," w-full")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(v.J,{htmlFor:"editBlueprintRunsPerCopy",className:h.label,children:"Runs per Invented Copy"}),(0,s.jsxs)(y.l6,{value:String(c.runs_per_copy||10),onValueChange:function(e){u(t=>t?{...t,runs_per_copy:parseInt(e,10)}:t)},children:[(0,s.jsx)(y.bq,{id:"editBlueprintRunsPerCopy",className:"".concat(h.selectTrigger," w-full"),children:(0,s.jsx)(y.yv,{})}),(0,s.jsxs)(y.gC,{className:h.selectContent,children:[(0,s.jsx)(y.eb,{value:"10",children:"10 Runs"}),(0,s.jsx)(y.eb,{value:"1",children:"1 Run"})]})]})]})]}),(0,s.jsxs)(j.Es,{children:[(0,s.jsx)(n.$,{type:"submit",className:h.buttonPrimary,children:"Save Changes"}),(0,s.jsx)(j.HM,{asChild:!0,children:(0,s.jsx)(n.$,{type:"button",variant:"secondary",className:h.buttonSecondary,children:"Cancel"})})]})]})]})})}var w=a(8539),C=a(356),_=a(3568);let S={T1:{modal:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border border-blue-800 shadow-2xl text-white",label:"text-blue-300",input:"bg-slate-800 border border-blue-700 text-blue-100 placeholder:text-blue-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",selectTrigger:"bg-slate-800 border border-blue-700 text-blue-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",selectContent:"bg-slate-900 text-white",buttonPrimary:"bg-blue-600 hover:bg-blue-500 focus:ring-2 focus:ring-blue-400 text-white font-semibold",buttonSecondary:"bg-slate-800 text-blue-300 hover:bg-blue-800 hover:text-white border border-blue-700",title:"text-blue-300",description:"text-blue-400"},T2:{modal:"rounded-2xl bg-gradient-to-br from-yellow-950 via-amber-900 to-orange-950 border border-amber-700 shadow-2xl text-[#f0e4c1]",label:"text-amber-300",input:"bg-[#4a2e08] border border-amber-600 text-[#f0e4c1] placeholder:text-amber-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 ",selectTrigger:"bg-[#4a2e08] border border-amber-600 text-[#f0e4c1] focus:ring-2 focus:ring-amber-400 focus:border-amber-400",selectContent:"bg-[#3e2f0f] text-[#f0e4c1]",buttonPrimary:"bg-amber-700 hover:bg-amber-600 focus:ring-2 focus:ring-amber-500 text-black font-semibold",buttonSecondary:"bg-[#2e1e06] text-amber-300 hover:bg-amber-800 hover:text-white border border-amber-600",title:"text-amber-400",description:"text-amber-300"}};function k(e){let{open:t,onClose:a}=e,[r,o]=(0,l.useState)("T1"),[d,c]=(0,l.useState)("game"),[u,x]=(0,l.useState)(""),[m,b]=(0,l.useState)(""),[h,p]=(0,l.useState)(""),[g,f]=(0,l.useState)(""),[y,N]=(0,l.useState)(""),[k,T]=(0,l.useState)(!1),E=S[r];async function F(e){e.preventDefault(),T(!0);let t="isk"===d?{name:function(e){var t;let a=null==(t=e.split("\n")[0])?void 0:t.match(/['"]?([^'"]+) Blueprint['"]?/i);return a?a[1]:"Unknown Blueprint"}(u),materials:u,sell_price:parseFloat(g),material_cost:parseFloat(y)}:{blueprintData:u,inventionData:m,inventionChance:h,sellPrice:g,makeCost:y,tier:r};try{if(!(await fetch("isk"===d?"/api/blueprints/blueprint":"/api/blueprints/from-game",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to add blueprint");_.oR.success("Blueprint added successfully"),a()}catch(e){_.oR.error("Failed to add blueprint"),console.error("Error adding blueprint:",e)}finally{T(!1)}}return(0,s.jsx)(j.lG,{open:t,onOpenChange:e=>!e&&a(),children:(0,s.jsxs)(j.Cf,{className:S[r].modal+" w-full max-w-2xl scale-110",children:[(0,s.jsxs)(j.c7,{className:"mb-4",children:[(0,s.jsx)(j.L3,{className:S[r].title+" text-lg font-semibold",children:"Add Blueprint"}),(0,s.jsx)(j.rr,{className:E.description,children:"Paste in your blueprint data from game or ISK/hour"})]}),(0,s.jsxs)("form",{onSubmit:F,className:"space-y-6",children:[(0,s.jsxs)("div",{className:E.label+" flex gap-4",children:[(0,s.jsxs)(v.J,{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"radio",checked:"game"===d,onChange:()=>c("game")})," From Game"]}),(0,s.jsxs)(v.J,{className:S[r].label,children:[(0,s.jsx)("input",{type:"radio",checked:"isk"===d,onChange:()=>c("isk")})," From ISK/Hour"]})]}),"game"===d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(C.z,{value:r,onValueChange:e=>o(e),className:"flex gap-4 ".concat(E.label),children:[(0,s.jsxs)(v.J,{htmlFor:"T1",className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,s.jsx)(C.C,{id:"T1",value:"T1",className:"border-blue-500 data-[state=checked]:bg-blue-400 data-[state=checked]:ring-2 data-[state=checked]:ring-blue-500"}),"T1"]}),(0,s.jsxs)(v.J,{htmlFor:"T2",className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,s.jsx)(C.C,{id:"T2",value:"T2",className:"border-amber-500 data-[state=checked]:bg-amber-400 data-[state=checked]:ring-2 data-[state=checked]:ring-amber-500"}),"T2"]})]}),(0,s.jsx)(w.T,{placeholder:"Paste blueprint data from game",value:u,onChange:e=>x(e.target.value),className:"".concat(E.input," placeholder:").concat(E.label," min-h-[120px] resize-y ")}),"T2"===r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.T,{placeholder:"Paste invention materials",value:m,onChange:e=>b(e.target.value),className:"".concat(E.input," placeholder:").concat(E.label)}),(0,s.jsx)(i.p,{placeholder:"Invention chance % (e.g. 42.5)",value:h,onChange:e=>p(e.target.value),className:"".concat(E.input," placeholder:").concat(E.label)})]})]}),"isk"===d&&(0,s.jsx)(w.T,{placeholder:"Paste ISK/hour format material list here",value:u,onChange:e=>x(e.target.value),className:"".concat(E.input," placeholder:").concat(E.label," min-h-[120px] resize-y")}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(i.p,{placeholder:"Sell Price",value:g,onChange:e=>f(e.target.value),className:"".concat(E.input," placeholder:").concat(E.label)}),(0,s.jsx)(i.p,{placeholder:"Make Cost",value:y,onChange:e=>N(e.target.value),className:"".concat(E.input," placeholder:").concat(E.label)})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,s.jsx)(n.$,{type:"submit",className:S[r].buttonPrimary,disabled:k,children:k?"Adding...":"Add Blueprint"}),(0,s.jsx)(n.$,{type:"button",variant:"secondary",className:S[r].buttonSecondary,onClick:a,children:"Cancel"})]})]})]})})}a(8277);let T=async(e,t)=>{t(!0);try{let t=await fetch("/api/blueprints/blueprints");if(!t.ok)throw Error("Failed to fetch blueprints");let a=await t.json();return e(a),console.log("Fetched blueprints:",a),a}catch(e){return console.error("Fetch error:",e),o.o.error("Failed to load blueprints"),[]}finally{t(!1)}};function E(){let[e,t]=(0,l.useState)(!1),[a,r]=(0,l.useState)(null),[i,d]=(0,l.useState)(!1),[c,u]=(0,l.useState)(null),[x,m]=(0,l.useState)(!1),[h,p]=(0,l.useState)([]);async function g(e){try{if(!(await fetch("/api/blueprints/blueprint/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to update blueprint");o.o.success("Blueprint updated");let a=(await T(p,m)).find(t=>t.id===e.id);r(null!=a?a:null),t(!1),r(null)}catch(e){console.error("Error updating blueprint:",e)}}async function j(e){try{let t=await fetch("/api/blueprints/blueprints",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to add blueprint");let a=await t.json();a.message?o.o.success(a.message):o.o.error(a.error)}catch(e){console.error(e),alert("Failed to update blueprint")}}return(0,l.useEffect)(()=>{console.log("Blueprints state changed:",h)},[h]),(0,l.useEffect)(()=>{T(p,m)},[]),(0,s.jsxs)(b.Zp,{className:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full ",children:[(0,s.jsx)(b.aR,{className:"px-6 pb-2",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,s.jsx)(b.ZB,{className:"text-2xl text-blue-100",children:"Blueprints Overview"}),(0,s.jsx)(b.BT,{className:"text-blue-400",children:"View and Manage Blueprints"})]}),(0,s.jsx)(n.$,{onClick:()=>d(!0),className:"bg-gradient-to-r from-blue-700 via-blue-900 to-blue-800 text-white hover:from-blue-800 hover:to-blue-900 relative top-[10px] left-[-35px] scale-125",children:"+ Add Blueprints"})]})}),(0,s.jsx)(f,{onEdit:function(e,a){r(e),u(a),t(!0)},blueprints:h,onSetBlueprints:p,loading:x,fetchBlueprints:()=>T(p,m)}),(0,s.jsxs)("div",{className:"flex flex-col items-start gap-2 px-6 pt-4",children:[(0,s.jsx)(n.$,{id:"update-blueprints-btn",className:"w-fit text-sm bg-blue-700 hover:bg-blue-800 mx-auto",onClick:async()=>{let e=document.getElementById("update-blueprints-status");e&&(e.textContent="Updating blueprint prices...",document.title="Updating blueprint prices...");try{let t=await fetch("/api/blueprints/update_prices",{method:"POST",headers:{"Content-Type":"application/json"}});if(t.ok){let a=await t.json();e&&(e.textContent=a.message||"Prices updated successfully!"),T(p,m)}else{let a=await t.json();e&&(e.textContent=a.error||"Failed to update prices.")}}catch(t){e&&(e.textContent="Error updating prices: "+t)}},children:"Update All Blueprint Prices (Cost and Sell)"}),(0,s.jsx)("div",{id:"update-blueprints-status",className:"text-sm text-blue-400 font-semibold"})]}),(0,s.jsx)(N,{open:e,blueprint:a,tier:c,onClose:()=>t(!1),onSave:g}),(0,s.jsx)(k,{open:i,onClose:()=>d(!1),onSubmit:j})]})}},1222:(e,t,a)=>{"use strict";a.d(t,{default:()=>j});var s=a(5155),l=a(2115),r=a(285),n=a(1154),i=a(549);function o(e){let{materials:t,loading:a,onEdit:l,onDelete:o}=e,d={};for(let e of t){let t=e.category||"Other";d[t]||(d[t]=[]),d[t].push(e)}return console.log("Rendering MaterialList with materials:",t),(0,s.jsx)("div",{className:"space-y-6",children:a?(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-blue-300 animate-pulse",children:[(0,s.jsx)(n.A,{className:"w-5 h-5 animate-spin"}),(0,s.jsx)("span",{children:"Loading materials..."})]}):0===Object.keys(d).length?(0,s.jsx)("p",{className:"text-sm text-blue-300 italic",children:"No materials found."}):(0,s.jsx)(i.nD,{type:"multiple",className:"w-full space-y-4",children:Object.entries(d).sort((e,t)=>{let[a]=e,[s]=t;return a.localeCompare(s)}).map(e=>{let[t,a]=e;return(0,s.jsxs)(i.As,{value:t,className:"rounded-2xl border border-blue-800 bg-gradient-to-br from-blue-950 via-slate-900 to-slate-950 shadow-lg",children:[(0,s.jsx)(i.$m,{className:"px-4 py-3 text-left text-lg font-semibold text-blue-200 hover:no-underline hover:text-blue-300",children:t}),(0,s.jsx)(i.ub,{className:"px-4 pb-4 space-y-3",children:a.map(e=>(0,s.jsxs)("div",{className:"flex justify-between items-center bg-slate-900/70 hover:bg-blue-900/60 border border-blue-800 rounded-xl px-4 py-2 shadow-sm transition-all",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-semibold text-blue-100",children:e.name}),(0,s.jsxs)("span",{className:"text-sm text-blue-300",children:[e.quantity.toLocaleString()," units"]})]}),(0,s.jsxs)("div",{className:"space-x-2",children:[(0,s.jsx)(r.$,{size:"sm",className:"bg-blue-700 hover:bg-blue-600 shadow-md hover:shadow-blue-500/30 text-white",onClick:()=>l(e),children:"Edit"}),(0,s.jsx)(r.$,{size:"sm",className:"bg-red-700 hover:bg-red-600 shadow-md hover:shadow-red-500/30 text-white",onClick:()=>o(e.id),children:"Delete"})]})]},e.id))})]},t)})})})}var d=a(4165),c=a(2523),u=a(9409);function x(e){let{material:t,open:a,onClose:n,onSave:i}=e,[o,x]=(0,l.useState)(0),[m,b]=(0,l.useState)(),[h,p]=(0,l.useState)("Other"),[g,f]=(0,l.useState)("");async function j(e){e.preventDefault(),t&&i({...t,quantity:o,type_id:m,category:"Other"===h?g:h})}return(0,l.useEffect)(()=>{if(t){var e;x(t.quantity),b(null!=(e=t.type_id)?e:void 0),p(t.category||"Other"),f("")}},[t]),(0,s.jsx)(d.lG,{open:a,onOpenChange:n,children:(0,s.jsxs)(d.Cf,{className:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full",children:[(0,s.jsx)(d.c7,{children:(0,s.jsxs)(d.L3,{className:"text-blue-300",children:["Edit Material",t?": ".concat(t.name):""]})}),(0,s.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,s.jsx)(c.p,{type:"number",placeholder:"Quantity",value:o,onChange:e=>x(Number(e.target.value)),required:!0,className:"bg-slate-900 border border-slate-700 text-blue-100"}),(0,s.jsx)(c.p,{type:"number",placeholder:"Type ID (optional)",value:null!=m?m:"",onChange:e=>b(Number(e.target.value)),className:"bg-slate-900 border border-slate-700 text-blue-100"}),(0,s.jsxs)(u.l6,{value:h,onValueChange:p,children:[(0,s.jsx)(u.bq,{className:"bg-slate-900 border border-slate-700 text-blue-100",children:(0,s.jsx)(u.yv,{placeholder:"Select category"})}),(0,s.jsxs)(u.gC,{className:"bg-slate-800 text-blue-100",children:[(0,s.jsx)(u.eb,{value:"Minerals",children:"Minerals"}),(0,s.jsx)(u.eb,{value:"Items",children:"Items"}),(0,s.jsx)(u.eb,{value:"Components",children:"Components"}),(0,s.jsx)(u.eb,{value:"Invention Materials",children:"Invention Materials"}),(0,s.jsx)(u.eb,{value:"Reaction Materials",children:"Reaction Materials"}),(0,s.jsx)(u.eb,{value:"Planetary Materials",children:"Planetary Materials"}),(0,s.jsx)(u.eb,{value:"Other",children:"Other"})]})]}),"Other"===h&&(0,s.jsx)(c.p,{type:"text",placeholder:"Enter custom category",value:g,onChange:e=>f(e.target.value),className:"bg-slate-900 border border-slate-700 text-blue-100"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,s.jsx)(r.$,{type:"submit",className:"bg-blue-700 hover:bg-blue-800 text-white",children:"Save"}),(0,s.jsx)(r.$,{type:"button",variant:"secondary",className:"bg-slate-700 text-blue-200",onClick:n,children:"Cancel"})]})]})]})})}var m=a(6695);a(8277);var b=a(356),h=a(5057),p=a(8539);function g(e){let{open:t,onClose:a,onSubmit:n}=e,[i,o]=(0,l.useState)(""),[c,u]=(0,l.useState)("replace"),[x,m]=(0,l.useState)(!1);async function g(e){if(e.preventDefault(),i.trim()){m(!0);try{await n({materialsText:i,updateType:c}),o(""),u("replace"),a()}catch(e){console.error("Error submitting materials:",e),alert("Error submitting materials, see console.")}finally{m(!1)}}}return(0,s.jsx)(d.lG,{open:t,onOpenChange:e=>!e&&a(),children:(0,s.jsxs)(d.Cf,{className:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full max-w-lg",children:[(0,s.jsx)(d.c7,{children:(0,s.jsx)(d.L3,{className:"text-blue-300 text-lg font-semibold",children:"Add Available Materials From Game (Copy/Paste)"})}),(0,s.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[(0,s.jsx)(p.T,{placeholder:"Paste available materials here",required:!0,value:i,onChange:e=>o(e.target.value),className:"bg-slate-900 border border-slate-700 text-blue-100 placeholder:text-blue-400 resize-y min-h-[120px]"}),(0,s.jsxs)(b.z,{value:c,onValueChange:e=>u(e),className:"flex flex-col gap-4 text-blue-200",children:[(0,s.jsxs)(h.J,{htmlFor:"addToMaterials",className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,s.jsx)(b.C,{id:"addToMaterials",value:"add",className:"border-blue-500 data-[state=checked]:bg-blue-400 data-[state=checked]:border-blue-200"}),"Add to existing materials (Replaces materials with the same name)"]}),(0,s.jsxs)(h.J,{htmlFor:"replaceMaterials",className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,s.jsx)(b.C,{id:"replaceMaterials",value:"replace",className:"border-blue-500 data-[state=checked]:bg-blue-400 data-[state=checked]:border-blue-200"}),"Replace ALL materials (Deletes all existing materials)"]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,s.jsx)(r.$,{type:"submit",className:"bg-blue-700 hover:bg-blue-800 text-white",disabled:x,children:x?"Updating...":"Update Available Materials"}),(0,s.jsx)(r.$,{type:"button",variant:"secondary",className:"bg-slate-700 text-blue-200 hover:bg-slate-600",onClick:a,disabled:x,children:"Cancel"})]})]})]})})}var f=a(3478);function j(){let[e,t]=(0,l.useState)(!1),[a,n]=(0,l.useState)(null),[d,c]=(0,l.useState)(!1),[u,b]=(0,l.useState)(!1),[h,p]=(0,l.useState)([]);function j(){n(null),t(!1)}async function v(e){try{await fetch("/api/materials/material/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),p(t=>t.map(t=>t.id===e.id?e:t)),j()}catch(e){console.error("Error updating material:",e)}}async function y(e){try{if(!(await fetch("/api/materials/parse",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to add materials");await w()}catch(e){console.error(e),alert("Failed to update materials")}}async function N(e){try{(await fetch("/api/materials/material/".concat(e),{method:"DELETE"})).ok?(p(t=>t.filter(t=>t.id!==e)),console.log("Material deleted successfully.")):console.error("Failed to delete material.")}catch(e){console.error("Error deleting material:",e)}}let w=async()=>{b(!0);try{let e=await fetch("/api/materials/materials");if(!e.ok)throw Error("Failed to fetch materials");let t=await e.json();p(t),console.log("Fetched materials:",t)}catch(e){console.error("Fetch error:",e)}finally{b(!1)}};return(0,l.useEffect)(()=>{console.log("Materials state changed:",h)},[h]),(0,l.useEffect)(()=>{w()},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(m.Zp,{className:"h-full rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full",children:[(0,s.jsx)(m.aR,{className:"px-6 pb-2",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,s.jsx)(m.ZB,{className:"text-2xl text-blue-100",children:"Available Materials"}),(0,s.jsx)(m.BT,{className:"text-blue-400",children:"View and Manage Materials"})]}),(0,s.jsx)(r.$,{onClick:()=>c(!0),className:"bg-gradient-to-r from-blue-700 via-blue-900 to-blue-800 text-white hover:from-blue-800 hover:to-blue-900 relative top-[5px] left-[-30px] scale-125",children:"+ Add Materials"})]})}),(0,s.jsx)(m.Wu,{className:"space-y-4",children:(0,s.jsx)(i.nD,{type:"single",collapsible:!0,defaultValue:"materials",children:(0,s.jsxs)(f.As,{value:"materials",className:"border-none bg-slate-900/60 rounded-xl overflow-hidden",children:[(0,s.jsx)(i.$m,{className:"text-blue-200 text-lg font-bold tracking-wide rounded-xl px-4 py-3 bg-blue-900/80 hover:bg-blue-800/80 hover:no-underline shadow transition-all",children:"View Materials Table (Split by Category)"}),(0,s.jsxs)(i.ub,{className:"bg-slate-900/80 px-2 pb-4 pt-2 rounded-b-xl space-y-4",children:[(0,s.jsx)("p",{id:"update-status",className:"text-sm text-gray-400 text-center"}),(0,s.jsx)(o,{materials:h,loading:u,onEdit:function(e){n(e),t(!0)},onDelete:N}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(r.$,{id:"update-materials-btn",className:"text-sm bg-blue-700 hover:bg-blue-800",onClick:async()=>{let e=document.getElementById("update-status");e&&(e.textContent="Updating material info...");try{let t=await fetch("/api/materials/update_material_info",{method:"POST",headers:{"Content-Type":"application/json"}});if(t.ok){let a=await t.json();e&&(e.textContent=a.message||"Material info updated successfully!"),w()}else{let a=await t.json();e&&(e.textContent=a.ERROR||"Failed to update material info.")}}catch(t){e&&(e.textContent="Error updating material info: "+t.message)}},children:"Update Material Info (TypeID and Category)"})})]})]})})})]}),(0,s.jsx)(g,{open:d,onClose:()=>c(!1),onSubmit:y}),a&&(0,s.jsx)(x,{material:a,open:e,onClose:j,onSave:v})]})}},2068:(e,t,a)=>{"use strict";a.d(t,{default:()=>v});var s=a(5155),l=a(2115),r=a(285),n=a(6695),i=a(3568),o=a(6021);function d(e){let{data:t}=e,a=t.true_profit/t.total_profit*100;return(0,s.jsxs)("div",{className:"rounded-2xl bg-gradient-to-br from-blue-950 via-slate-900 to-slate-950 p-6 shadow-xl border border-blue-800 w-full",children:[(0,s.jsx)("h3",{className:"text-2xl text-blue-200 font-bold mb-4",children:"Optimization Summary"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 text-center text-blue-100",children:[(0,s.jsx)(c,{title:"Total Profit",value:t.total_profit,color:"text-green-400"}),(0,s.jsx)(c,{title:"True Profit",value:t.true_profit,color:"text-green-400"}),(0,s.jsx)(c,{title:"True Profit %",value:a,color:a<20?"text-red-400":a<35?"text-orange-400":a<50?"text-yellow-400":a<70?"text-green-400":"text-blue-400",isPercent:!0})]})]})}function c(e){let{title:t,value:a,color:r,isPercent:n}=e,[i,d]=(0,l.useState)(!1);return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center bg-slate-800 rounded-xl p-4 shadow-md border border-blue-800 hover:shadow-blue-500/40 hover:border-blue-500 transition duration-300 cursor-pointer",onClick:()=>{d(e=>!e)},title:"Click to toggle value format",children:[(0,s.jsx)("span",{className:"text-sm text-blue-300",children:t}),(0,s.jsxs)("span",{className:"text-xl font-semibold ".concat(r," transition-all duration-200"),children:[n?"".concat(a.toFixed(2),"%"):i?(0,o.G)(a):a.toLocaleString()," ISK"]})]})}function u(e){let{data:t}=e;if(!t||0===Object.keys(t).length)return null;let a=Object.entries(t).sort((e,t)=>e[0].localeCompare(t[0]));return(0,s.jsxs)("div",{className:"rounded-2xl bg-gradient-to-br from-blue-950 via-slate-900 to-slate-950 p-4 shadow-xl border border-blue-800 w-full",children:[(0,s.jsx)("h3",{className:"text-xl text-blue-300 font-semibold",children:"Required Component Production"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left text-blue-100 rounded-lg overflow-hidden border border-blue-800",children:[(0,s.jsx)("thead",{className:"bg-blue-800 text-blue-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2",children:"Component"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Quantity Needed"})]})}),(0,s.jsx)("tbody",{children:a.map(e=>{let[t,a]=e;return(0,s.jsxs)("tr",{className:"border-t border-blue-800",children:[(0,s.jsx)("td",{className:"px-4 py-1",children:t}),(0,s.jsx)("td",{className:"px-4 py-1",children:a.toLocaleString()})]},t)})})]})})]})}function x(e){let{data:t}=e,a=Object.entries(t).filter(e=>{let[t,a]=e;return a>0}).sort((e,t)=>e[0].localeCompare(t[0]));return 0===a.length?null:(0,s.jsxs)("div",{className:"rounded-2xl bg-gradient-to-br from-blue-950 via-slate-900 to-slate-950 p-4 shadow-xl border border-blue-800 w-full",children:[(0,s.jsx)("h3",{className:"text-xl text-blue-300 font-semibold",children:"Production Plan"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left text-blue-100 rounded-lg overflow-hidden border border-blue-800",children:[(0,s.jsx)("thead",{className:"bg-blue-800 text-blue-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2",children:"Blueprint"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Quantity"})]})}),(0,s.jsx)("tbody",{children:a.map(e=>{let[t,a]=e;return(0,s.jsxs)("tr",{className:"border-t border-blue-800",children:[(0,s.jsx)("td",{className:"px-4 py-1",children:t}),(0,s.jsx)("td",{className:"px-4 py-1",children:a.toLocaleString()})]},t)})})]})})]})}var m=a(9434),b=a(6474),h=a(3052);let p=["Tritanium","Pyerite","Mexallon","Isogen","Nocxium","Zydrine","Megacyte","Morphite"],g=["Minerals","Components","Items","Invention Materials","Reaction Materials","Salvaged Materials","Planetary Materials","Fuel","Other"];function f(e){let{usage:t}=e,a={},[r,n]=(0,l.useState)(!1);for(let e in t){var i,o;let s=t[e],l=null!=(o=null==(i=s.category)?void 0:i.trim())?o:"Other";p.includes(e)&&(l="Minerals"),g.includes(l)||(l="Other"),a[l]||(a[l]={}),a[l][e]=s}return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-2xl text-blue-300 font-semibold mb-2",children:"Material Usage by Category"}),(0,s.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:g.map(e=>{let t=a[e];if(!t)return null;let l=Object.values(t).filter(e=>e.used>0).length,i=Object.keys(t).length;return(0,s.jsxs)("div",{className:(0,m.cn)("rounded-xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border border-blue-800 shadow-md transition-all",r?"ring-2 ring-blue-600 shadow-xl":"hover:ring-1 hover:ring-blue-600"),children:[(0,s.jsxs)("div",{className:"cursor-pointer flex justify-between items-center p-4",onClick:()=>n(!r),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-lg text-blue-200 font-bold",children:e}),(0,s.jsxs)("p",{className:"text-blue-400 text-sm",children:[i," total kind(s) of ",e," — ",l," used"]})]}),(0,s.jsx)("div",{className:"text-blue-400",children:r?(0,s.jsx)(b.A,{}):(0,s.jsx)(h.A,{})})]}),r&&(0,s.jsxs)("div",{className:"px-4 pb-4 space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-xs text-blue-300 font-semibold border-b border-blue-800 pb-1",children:[(0,s.jsx)("div",{className:"w-1/3",children:"Material"}),(0,s.jsx)("div",{className:"w-1/4 text-right",children:"Used"}),(0,s.jsx)("div",{className:"w-1/4 text-right",children:"Remaining"}),(0,s.jsx)("div",{className:"w-1/5 text-right",children:"Used %"})]}),Object.entries(t).sort((e,t)=>e[0].localeCompare(t[0])).map(e=>{let[t,a]=e,l=a.used+a.remaining,r=l>0?a.used/l*100:0,n=r>=200?"text-red-900":r>=150?"text-red-700":r>=120?"text-orange-700":r>=100?"text-orange-500":r>=80?"text-yellow-500":r>=60?"text-green-500":r>=40?"text-green-300":"text-blue-300",i=r>=200?"text-red-900":r>=180?"text-red-800":r>=160?"text-red-700":r>=140?"text-red-600":r>=120?"text-red-500":r>=90?"text-red-400":r>=70?"text-yellow-500":r>=50?"text-green-500":r>=30?"text-green-300":"text-blue-300",o=Math.min(r,100);return(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm text-blue-100",children:[(0,s.jsx)("div",{className:"w-1/3 truncate",children:t}),(0,s.jsx)("div",{className:"w-1/4 text-rose-400 text-right",children:a.used.toLocaleString()}),(0,s.jsx)("div",{className:(0,m.cn)("w-1/4 text-right",i),children:a.remaining.toLocaleString()}),(0,s.jsxs)("div",{className:"w-1/5 text-right ".concat(n),children:[r.toFixed(1),"%"]})]}),(0,s.jsx)("div",{className:"h-1 bg-slate-800 rounded overflow-hidden",children:(0,s.jsx)("div",{className:(0,m.cn)("h-full transition-all duration-300 ease-in-out",r>=200?"bg-red-900":r>=180?"bg-red-800":r>=160?"bg-red-700":r>=140?"bg-red-600":r>=120?"bg-red-500":r>=90?"bg-red-400":r>=70?"bg-yellow-500":r>=50?"bg-green-500":r>=30?"bg-green-300":"bg-blue-300"),style:{width:"".concat(o,"%")}})})]},t)})]})]},e)})})]})}function j(e){let{materialUsage:t}=e,a=Object.entries(t).map(e=>{let[t,a]=e,s=a.used+a.remaining;return{name:t,percent:s>0?a.used/s*100:0}}).filter(e=>e.percent>90).sort((e,t)=>t.percent-e.percent);return 0===a.length?null:(0,s.jsxs)("div",{className:"rounded-2xl bg-gradient-to-br from-blue-950 via-slate-900 to-slate-950 p-6 shadow-xl border border-blue-800 w-full",children:[(0,s.jsx)("h3",{className:"text-xl text-blue-300 font-semibold mb-4",children:"Bottleneck Materials"}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:a.map(e=>{let{name:t,percent:a}=e;return(0,s.jsxs)("div",{className:"bg-slate-900/80 border border-blue-800 rounded-xl p-4 shadow hover:shadow-blue-700 transition-all duration-300",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,s.jsx)("span",{className:"text-blue-100 font-medium",children:t}),(0,s.jsxs)("span",{className:"text-xs font-bold px-2 py-1 rounded-full ".concat(a>=200?"bg-red-800 text-red-200":a>=120?"bg-yellow-800 text-yellow-100":a>=90?"bg-orange-700 text-orange-100":a>=60?"bg-blue-700 text-blue-100":"bg-blue-900 text-blue-300"),children:[a.toFixed(1),"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-slate-800 rounded-full h-2.5 overflow-hidden",children:(0,s.jsx)("div",{className:"h-full transition-all duration-300 ease-in-out ".concat(a>=200?"bg-red-900":a>=180?"bg-red-800":a>=160?"bg-red-700":a>=140?"bg-red-600":a>=120?"bg-orange-600":a>=100?"bg-orange-500":a>=90?"bg-yellow-500":a>=70?"bg-yellow-400":a>=50?"bg-green-500":a>=30?"bg-blue-500":"bg-blue-300"),style:{width:"".concat(a,"%")},title:"".concat(a.toFixed(2),"% used")})})]},t)})})]})}function v(){let[e,t]=(0,l.useState)(null),[a,o]=(0,l.useState)(!1),c=async()=>{o(!0);try{let e=await fetch("/api/blueprints/optimize");if(!e.ok)throw Error("Failed to optimize");let a=await e.json();t(a),i.Ay.success("Optimization complete!")}catch(e){console.error("Optimization failed:",e),i.Ay.error("Failed to optimize: "+e)}finally{o(!1)}},m=null!==e?{total_profit:e.total_profit,true_profit:e.true_profit}:null;return(0,s.jsxs)(n.Zp,{className:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full p-6",children:[(0,s.jsx)(n.aR,{children:(0,s.jsx)(n.ZB,{className:"text-2xl text-blue-100 mb-2",children:"Optimize Production"})}),(0,s.jsxs)(n.Wu,{className:"flex flex-col items-center space-y-6",children:[(0,s.jsx)(r.$,{onClick:c,disabled:a,className:"bg-blue-900 hover:bg-blue-700 text-white font-bold text-lg py-4 px-6 rounded-lg shadow-lg shadow-blue-500/50 transition duration-300 ease-in-out hover:scale-110 hover:shadow-xl",children:a?"Optimizing...":"OPTIMIZE PRODUCTION"}),e&&(0,s.jsxs)("div",{className:"w-full space-y-6",children:[m&&(0,s.jsx)(d,{data:m}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)(u,{data:e.dependencies_needed}),(0,s.jsx)(x,{data:e.what_to_produce})]}),(0,s.jsx)(f,{usage:e.material_usage}),(0,s.jsx)(j,{materialUsage:e.material_usage})]})]})]})}a(8277)},2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>r});var s=a(5155);a(2115);var l=a(9434);function r(e){let{className:t,type:a,...r}=e;return(0,s.jsx)("input",{type:a,"data-slot":"input",className:(0,l.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}},2530:(e,t,a)=>{"use strict";a.d(t,{default:()=>i});var s=a(5155),l=a(2115),r=a(285),n=a(9434);function i(e){let{characterName:t}=e,[a,i]=(0,l.useState)(!1),[o,d]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{d(!0)},[]),o)?(0,s.jsxs)("div",{className:"flex flex-col items-center my-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6 text-blue-300",children:"EVE Online Manufacturing Optimizer"}),t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"my-4 font-bold text-blue-200",children:["Welcome, ",t,"!"]}),(0,s.jsx)("form",{action:"/logout",method:"POST",className:"inline",children:(0,s.jsx)(r.$,{type:"submit",variant:"secondary",className:"px-4 py-2 text-blue-100 bg-blue-800 hover:bg-blue-700",children:"Logout"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.$,{className:(0,n.cn)("bg-gradient-to-r from-blue-900 via-blue-700 to-blue-500 text-white shadow-lg","hover:from-blue-800 hover:to-blue-600 transition-all duration-200"),disabled:a,onClick:()=>{i(!0),window.location.href="/login"},size:"lg",children:a?"Logging in...":"Log in with EVE Online"}),(0,s.jsx)("div",{className:"mt-4 font-semibold text-blue-200",children:a&&"Redirecting to EVE SSO..."})]})]}):null}},4165:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>u,Es:()=>m,HM:()=>d,L3:()=>b,c7:()=>x,lG:()=>i,rr:()=>h});var s=a(5155);a(2115);var l=a(5452),r=a(4416),n=a(9434);function i(e){let{...t}=e;return(0,s.jsx)(l.bL,{"data-slot":"dialog",...t})}function o(e){let{...t}=e;return(0,s.jsx)(l.ZL,{"data-slot":"dialog-portal",...t})}function d(e){let{...t}=e;return(0,s.jsx)(l.bm,{"data-slot":"dialog-close",...t})}function c(e){let{className:t,...a}=e;return(0,s.jsx)(l.hJ,{"data-slot":"dialog-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function u(e){let{className:t,children:a,showCloseButton:i=!0,...d}=e;return(0,s.jsxs)(o,{"data-slot":"dialog-portal",children:[(0,s.jsx)(c,{}),(0,s.jsxs)(l.UC,{"data-slot":"dialog-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...d,children:[a,i&&(0,s.jsxs)(l.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(r.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function x(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:(0,n.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function m(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-footer",className:(0,n.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function b(e){let{className:t,...a}=e;return(0,s.jsx)(l.hE,{"data-slot":"dialog-title",className:(0,n.cn)("text-lg leading-none font-semibold",t),...a})}function h(e){let{className:t,...a}=e;return(0,s.jsx)(l.VY,{"data-slot":"dialog-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...a})}},4886:(e,t,a)=>{"use strict";a.d(t,{default:()=>h});var s=a(5155),l=a(2115),r=a(285),n=a(4165),i=a(2523),o=a(5057);function d(e){let{open:t,onOpenChange:a,onStationAdded:d}=e,[c,u]=(0,l.useState)(""),[x,m]=(0,l.useState)(""),[b,h]=(0,l.useState)(null),[p,g]=(0,l.useState)(!1),f=async e=>{e.preventDefault(),g(!0),h(null);try{let e=await fetch("/api/stations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:c.trim(),station_id:parseInt(x,10)})}),t=await e.json();e.ok?(h({success:!0,message:"✅ Station added successfully!"}),u(""),m(""),d&&d()):h({success:!1,message:"❌ ".concat(t.error||"Unknown error")})}catch(e){h({success:!1,message:"❌ Network error"})}finally{g(!1)}},j=()=>{h(null),u(""),m(""),a(!1)};return(0,s.jsx)(n.lG,{open:t,onOpenChange:j,children:(0,s.jsxs)(n.Cf,{className:"max-w-md bg-slate-900 text-blue-100 border border-blue-700",children:[(0,s.jsx)(n.c7,{children:(0,s.jsx)(n.L3,{className:"text-blue-300",children:"Add New Station"})}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"stationName",className:"font-semibold text-blue-200",children:"Station Name"}),(0,s.jsx)(i.p,{id:"stationName",name:"stationName",placeholder:"e.g., Neo Nexus Refinery",value:c,onChange:e=>u(e.target.value),required:!0,className:"bg-slate-800 text-blue-100 border-blue-700 mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"stationId",className:"font-semibold text-blue-200",children:"Station ID"}),(0,s.jsx)(i.p,{id:"stationId",name:"stationId",type:"number",placeholder:"e.g., 1024012922938",value:x,onChange:e=>m(e.target.value),required:!0,className:"bg-slate-800 text-blue-100 border-blue-700 mt-1"})]}),b&&(0,s.jsx)("div",{className:"mt-2 font-semibold ".concat(b.success?"text-green-400":"text-red-400"),children:b.message}),(0,s.jsxs)(n.Es,{className:"gap-2",children:[(0,s.jsx)(r.$,{type:"submit",disabled:p,className:"bg-gradient-to-r from-blue-700 via-blue-900 to-blue-800 text-white font-bold",children:p?"Adding...":"Add Station"}),(0,s.jsx)(r.$,{type:"button",variant:"secondary",onClick:j,className:"bg-slate-700 text-blue-200 hover:bg-slate-600",children:"Close"})]})]})]})})}function c(e){let{open:t,onOpenChange:a,stations:l,loading:i,error:o,onEditStation:d,onDeleteStation:c}=e;return(0,s.jsx)(n.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(n.Cf,{className:"max-w-lg bg-slate-900 text-blue-100 border border-blue-700",children:[(0,s.jsx)(n.c7,{children:(0,s.jsx)(n.L3,{className:"text-blue-300",children:"Stations"})}),(0,s.jsxs)("div",{className:"space-y-4 max-h-[50vh] overflow-y-auto",children:[i&&(0,s.jsx)("div",{children:"Loading stations..."}),o&&(0,s.jsx)("div",{className:"text-red-400",children:o}),!i&&!o&&0===l.length&&(0,s.jsx)("div",{className:"text-blue-400",children:"No stations added yet."}),!i&&!o&&l.length>0&&(0,s.jsxs)("table",{className:"w-full text-left border-separate border-spacing-y-2",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"pr-2",children:"Name"}),(0,s.jsx)("th",{className:"pr-2",children:"ID"}),(0,s.jsx)("th",{className:"pr-2",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:l.map(e=>(0,s.jsxs)("tr",{className:"bg-slate-800 rounded",children:[(0,s.jsx)("td",{className:"pr-2",children:e.name}),(0,s.jsx)("td",{className:"pr-2",children:e.station_id}),(0,s.jsxs)("td",{className:"flex gap-2",children:[(0,s.jsx)(r.$,{size:"sm",variant:"secondary",className:"bg-blue-700 text-white",onClick:()=>d(e),children:"Edit"}),c&&(0,s.jsx)(r.$,{size:"sm",variant:"destructive",onClick:()=>c(e.id),children:"Delete"})]})]},e.id))})]})]}),(0,s.jsx)(n.Es,{children:(0,s.jsx)(r.$,{variant:"secondary",onClick:()=>a(!1),children:"Close"})})]})})}function u(e){let{open:t,onOpenChange:a,station:d,onStationUpdate:c}=e,[u,x]=(0,l.useState)(""),[m,b]=(0,l.useState)(""),[h,p]=(0,l.useState)(null),[g,f]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{if(d)x(d.name),b(d.station_id.toString()),p(null);else{x(""),b(""),p(null);return}},[d,t]),!d)return null;let j=async e=>{if(e.preventDefault(),f(!0),p(null),!u.trim()||!m.trim()){p({success:!1,message:"Name and Station ID cannot be empty"}),f(!1);return}try{let e=await fetch("/api/stations/".concat(d.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:u.trim(),station_id:parseInt(m,10)})});if(e.ok)p({success:!0,message:"✅ Station updated successfully!"}),c&&c({...d,name:u,station_id:parseInt(m,10)}),setTimeout(()=>a(!1),1500);else{let t=await e.json();p({success:!1,message:"❌ Error updating station: ".concat(t.error||"Unknown error")})}}catch(e){p({success:!1,message:"❌ Error updating station: ".concat(e instanceof Error?e.message:"Unknown error")})}finally{f(!1)}},v=()=>{p(null),a(!1)};return(0,s.jsx)(n.lG,{open:t,onOpenChange:v,children:(0,s.jsxs)(n.Cf,{className:"max-w-md bg-slate-900 text-blue-100 border border-blue-700",children:[(0,s.jsx)(n.c7,{children:(0,s.jsx)(n.L3,{className:"text-blue-300",children:"Edit Station"})}),(0,s.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"editStationName",className:"font-semibold text-blue-200",children:"Name"}),(0,s.jsx)(i.p,{id:"editStationName",value:u,onChange:e=>x(e.target.value),required:!0,className:"bg-slate-800 text-blue-100 border-blue-700 mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"editStationStationId",className:"font-semibold text-blue-200",children:"Station ID"}),(0,s.jsx)(i.p,{id:"editStationStationId",type:"number",value:m,onChange:e=>b(e.target.value),required:!0,className:"bg-slate-800 text-blue-100 border-blue-700 mt-1"})]}),h&&(0,s.jsx)("div",{className:"mt-2 font-semibold ".concat(h.success?"text-green-400":"text-red-400"),children:h.message}),(0,s.jsxs)(n.Es,{className:"gap-2",children:[(0,s.jsx)(r.$,{type:"submit",disabled:g,className:"bg-gradient-to-r from-blue-700 via-blue-900 to-blue-800 text-white font-bold",children:g?"Saving...":"Save"}),(0,s.jsx)(r.$,{type:"button",variant:"secondary",onClick:v,className:"bg-slate-700 text-blue-200",children:"Cancel"})]})]})]})})}function x(e){let{stations:t,loading:a=!1,error:l=null,onEdit:n,onDelete:i}=e;return a?(0,s.jsx)("div",{className:"text-blue-200 p-6 text-center",children:"Loading stations..."}):l?(0,s.jsx)("div",{className:"text-red-400 p-6 text-center",children:l}):t.length?(0,s.jsxs)("table",{className:"w-full text-left border-separate border-spacing-y-2",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"pr-2 py-2 text-blue-400",children:"Name"}),(0,s.jsx)("th",{className:"pr-2 py-2 text-blue-400",children:"ID"}),(0,s.jsx)("th",{className:"pr-2 py-2 text-blue-400 text-center",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:t.map(e=>(0,s.jsxs)("tr",{className:"bg-slate-800/80 hover:bg-blue-900/50 transition rounded-xl",children:[(0,s.jsx)("td",{className:"pr-2 py-2 rounded-l-xl font-semibold text-blue-100",children:e.name}),(0,s.jsx)("td",{className:"pr-2 py-2 text-blue-300",children:e.station_id}),(0,s.jsxs)("td",{className:"pr-2 py-2 rounded-r-xl flex gap-2 justify-center",children:[n&&(0,s.jsx)(r.$,{size:"sm",variant:"secondary",className:"bg-blue-700 text-white hover:bg-blue-800 transition",onClick:()=>n(e),children:"Edit"}),i&&(0,s.jsx)(r.$,{size:"sm",variant:"destructive",className:"hover:bg-red-700 transition",onClick:()=>i(e.id),children:"Delete"})]})]},e.id))})]}):(0,s.jsx)("div",{className:"text-blue-400 p-6 text-center",children:"No stations added yet."})}a(8277);var m=a(6695),b=a(549);function h(){let[e,t]=(0,l.useState)(!1),[a,n]=(0,l.useState)(!1),[i,o]=(0,l.useState)(!1),[h,p]=(0,l.useState)([]),[g,f]=(0,l.useState)(!0),[j,v]=(0,l.useState)(null),[y,N]=(0,l.useState)(null),[w,C]=(0,l.useState)(!1);async function _(){f(!0),console.log("MSW ready. Requesting /api/stations");try{let e=await fetch("/api/stations");if(!e.ok)throw Error("HTTP ".concat(e.status));let t=await e.json();p(t)}catch(e){console.error("Failed to fetch stations:",e)}finally{f(!1)}}(0,l.useEffect)(()=>{_()},[]);let S=e=>{N(e),o(!0)},k=async e=>{try{let t=await fetch("/api/stations/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.name,station_id:e.station_id})});if(!t.ok)throw Error("Failed to update station, status ".concat(t.status));await _()}catch(e){console.error("Error updating station:",e)}},T=async e=>{if(window.confirm("Are you sure you want to delete this station?"))try{let t=await fetch("/api/stations/".concat(e),{method:"DELETE"});if(t.ok)p(t=>t.filter(t=>t.id!==e));else{let e=await t.json();alert("Error: "+(e.error||"Unknown error"))}}catch(e){alert("Error: "+(e instanceof Error?e.message:"Unknown error"))}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(m.Zp,{className:"h-full rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full",children:[(0,s.jsx)(m.aR,{className:"px-6 pb-2",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.ZB,{className:"text-2xl text-blue-100",children:"Your Stations"}),(0,s.jsx)(m.BT,{className:"text-blue-400",children:"Manage your selling stations. (If none, Jita will be used)"})]}),(0,s.jsx)(r.$,{onClick:()=>t(!0),className:"bg-gradient-to-r from-blue-700 via-blue-900 to-blue-800 text-white hover:from-blue-800 hover:to-blue-900 scale-120 relative right-2",children:"+ Add Station"})]})}),(0,s.jsx)(m.Wu,{className:"px-6 pb-6",children:(0,s.jsx)(b.nD,{type:"single",collapsible:!0,defaultValue:"stations",children:(0,s.jsxs)(b.As,{value:"stations",className:"border-none bg-slate-900/60 rounded-xl overflow-hidden",children:[(0,s.jsx)(b.$m,{className:"text-blue-200 text-lg font-bold tracking-wide rounded-xl px-4 py-3 bg-blue-900/80 hover:bg-blue-800/80 hover:no-underline shadow transition-all",children:"View Station List"}),(0,s.jsx)(b.ub,{className:"bg-slate-900/80 px-2 pb-4 pt-2 rounded-b-xl",children:(0,s.jsx)(x,{stations:h,loading:g,error:j,onEdit:S,onDelete:T})})]})})})]}),(0,s.jsx)(c,{open:a,onOpenChange:n,stations:h,loading:g,error:j,onEditStation:S}),y&&(0,s.jsx)(u,{open:i,onOpenChange:o,station:y,onStationUpdate:k}),(0,s.jsx)(d,{open:e,onOpenChange:t})]})}},5057:(e,t,a)=>{"use strict";a.d(t,{J:()=>n});var s=a(5155);a(2115);var l=a(968),r=a(9434);function n(e){let{className:t,...a}=e;return(0,s.jsx)(l.b,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}},6021:(e,t,a)=>{"use strict";a.d(t,{G:()=>n,a:()=>i});var s=a(5155),l=a(2115),r=a(285);function n(e){return e>=1e9?(e/1e9).toFixed(2)+"b":e>=1e6?(e/1e6).toFixed(2)+"m":e>=1e3?(e/1e3).toFixed(2)+"k":e.toString()}function i(e){let{onDelete:t,children:a}=e,[n,i]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if(!n)return;let e=setTimeout(()=>i(!1),3e3);return()=>clearTimeout(e)},[n]),(0,s.jsx)(r.$,{size:"sm",variant:"destructive",onClick:()=>{n?(t(),i(!1)):i(!0)},className:"transition-colors ".concat(n?"bg-red-700 hover:bg-red-900":"bg-red-600 hover:bg-red-800"),children:n?"Confirm Delete?":a})}},6695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>o,Wu:()=>d,ZB:()=>i,Zp:()=>r,aR:()=>n});var s=a(5155);a(2115);var l=a(9434);function r(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,l.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,l.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,l.cn)("leading-none font-semibold",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,l.cn)("text-muted-foreground text-sm",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,l.cn)("px-6",t),...a})}},8277:(e,t,a)=>{"use strict";let s=!1;new Promise(e=>{if(s)return e();Object.defineProperty(globalThis,"__MSW_READY__",{set:()=>{s=!0,e()},configurable:!0})})},8539:(e,t,a)=>{"use strict";a.d(t,{T:()=>r});var s=a(5155);a(2115);var l=a(9434);function r(e){let{className:t,...a}=e;return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,l.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}},9409:(e,t,a)=>{"use strict";a.d(t,{bq:()=>u,eb:()=>m,gC:()=>x,l6:()=>d,yv:()=>c});var s=a(5155);a(2115);var l=a(2697),r=a(6474),n=a(5196),i=a(7863),o=a(9434);function d(e){let{...t}=e;return(0,s.jsx)(l.bL,{"data-slot":"select",...t})}function c(e){let{...t}=e;return(0,s.jsx)(l.WT,{"data-slot":"select-value",...t})}function u(e){let{className:t,size:a="default",children:n,...i}=e;return(0,s.jsxs)(l.l9,{"data-slot":"select-trigger","data-size":a,className:(0,o.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[n,(0,s.jsx)(l.In,{asChild:!0,children:(0,s.jsx)(r.A,{className:"size-4 opacity-50"})})]})}function x(e){let{className:t,children:a,position:r="popper",...n}=e;return(0,s.jsx)(l.ZL,{children:(0,s.jsxs)(l.UC,{"data-slot":"select-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,s.jsx)(b,{}),(0,s.jsx)(l.LM,{className:(0,o.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(h,{})]})})}function m(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(l.q7,{"data-slot":"select-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(l.VF,{children:(0,s.jsx)(n.A,{className:"size-4"})})}),(0,s.jsx)(l.p4,{children:a})]})}function b(e){let{className:t,...a}=e;return(0,s.jsx)(l.PP,{"data-slot":"select-scroll-up-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(i.A,{className:"size-4"})})}function h(e){let{className:t,...a}=e;return(0,s.jsx)(l.wn,{"data-slot":"select-scroll-down-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(r.A,{className:"size-4"})})}},9434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>r});var s=a(2596),l=a(9688);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,l.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[805,441,684,358],()=>t(373)),_N_E=e.O()}]);