(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2522:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eV});var l=a(5155),s=a(6671),r=a(2115),n=a(9708),i=a(2085),o=a(2596),d=a(9688);function c(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,d.QP)((0,o.$)(t))}let u=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function x(e){let{className:t,variant:a,size:s,asChild:r=!1,...i}=e,o=r?n.DX:"button";return(0,l.jsx)(o,{"data-slot":"button",className:c(u({variant:a,size:s,className:t})),...i})}let m=!1,b=new Promise(e=>{if(m||"undefined"!=typeof globalThis&&!0===globalThis.__MSW_READY__){m=!0,e();return}Object.defineProperty(globalThis,"__MSW_READY__",{set:t=>{!0===t&&(m=!0,e())},configurable:!0})});function h(){let[e,t]=(0,r.useState)(),[a,s]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=async()=>{i(!0);try{let e=new AbortController,a=setTimeout(()=>e.abort(),5e3),l=await fetch("/auth/status",{credentials:"include",signal:e.signal});if(clearTimeout(a),!l.ok)throw Error("HTTP error ".concat(l.status));let s=await l.json();console.log("FETCHED LOGIN STATUS:",s),s.logged_in?t(s.character_name):t(void 0)}catch(e){console.error("auth status fetch failed or timed out",e),t(void 0)}finally{i(!1)}};e();let a=async()=>{await e()};return window.addEventListener("focus",a),()=>{window.removeEventListener("focus",a)}},[]);let o=async()=>{s(!0),localStorage.setItem("isLoggedIn","true"),window.location.href="/login"},d=async()=>{console.log("\uD83D\uDC4B handleLogout started");try{console.log("\uD83D\uDCE1 sending POST /logout...");let e=await fetch("/logout",{method:"POST",credentials:"include"});e.ok?(console.log("✅ Logged out successfully"),t(void 0)):console.error("❌ Logout failed",await e.text())}catch(e){console.error("⚠️ Error during logout",e)}};return(0,l.jsxs)("div",{className:"flex flex-col items-center my-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-6 text-blue-300",children:"EVE Online Manufacturing Optimizer"}),n?(0,l.jsx)("div",{className:"text-blue-200 animate-pulse",children:"Checking login status..."}):e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"my-4 font-bold text-blue-200",children:["Welcome, ",e,"!"]}),e&&(0,l.jsx)(x,{onClick:()=>{console.log("logout clicked"),d()},variant:"secondary",className:"px-4 py-2 text-blue-100 bg-blue-800 hover:bg-blue-700",children:"Logout"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x,{className:c("bg-gradient-to-r from-blue-900 via-blue-700 to-blue-500 text-white shadow-lg","hover:from-blue-800 hover:to-blue-600 transition-all duration-200"),disabled:a,onClick:o,size:"lg",children:a?"Logging in...":"Log in with EVE Online"}),(0,l.jsx)("div",{className:"mt-4 font-semibold text-blue-200",children:a&&"Redirecting to EVE SSO..."})]})]})}var p=a(5452),g=a(4416);function f(e){let{...t}=e;return(0,l.jsx)(p.bL,{"data-slot":"dialog",...t})}function j(e){let{...t}=e;return(0,l.jsx)(p.ZL,{"data-slot":"dialog-portal",...t})}function v(e){let{...t}=e;return(0,l.jsx)(p.bm,{"data-slot":"dialog-close",...t})}function N(e){let{className:t,...a}=e;return(0,l.jsx)(p.hJ,{"data-slot":"dialog-overlay",className:c("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function y(e){let{className:t,children:a,showCloseButton:s=!0,...r}=e;return(0,l.jsxs)(j,{"data-slot":"dialog-portal",children:[(0,l.jsx)(N,{}),(0,l.jsxs)(p.UC,{"data-slot":"dialog-content",className:c("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r,children:[a,s&&(0,l.jsxs)(p.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,l.jsx)(g.A,{}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function w(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"dialog-header",className:c("flex flex-col gap-2 text-center sm:text-left",t),...a})}function _(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"dialog-footer",className:c("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function S(e){let{className:t,...a}=e;return(0,l.jsx)(p.hE,{"data-slot":"dialog-title",className:c("text-lg leading-none font-semibold",t),...a})}function k(e){let{className:t,...a}=e;return(0,l.jsx)(p.VY,{"data-slot":"dialog-description",className:c("text-muted-foreground text-sm",t),...a})}function C(e){let{className:t,type:a,...s}=e;return(0,l.jsx)("input",{type:a,"data-slot":"input",className:c("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...s})}var T=a(968);function F(e){let{className:t,...a}=e;return(0,l.jsx)(T.b,{"data-slot":"label",className:c("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}function E(e){let{open:t,onOpenChange:a,onStationAdded:s}=e,[n,i]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[c,u]=(0,r.useState)(null),[m,b]=(0,r.useState)(!1),h=async e=>{e.preventDefault(),b(!0),u(null);try{let e=await fetch("/api/stations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n.trim(),station_id:parseInt(o,10)})}),t=await e.json();e.ok?(u({success:!0,message:"✅ Station added successfully!"}),i(""),d(""),s&&s()):u({success:!1,message:"❌ ".concat(t.error||"Unknown error")})}catch(e){u({success:!1,message:"❌ Network error"})}finally{b(!1)}},p=()=>{u(null),i(""),d(""),a(!1)};return(0,l.jsx)(f,{open:t,onOpenChange:p,children:(0,l.jsxs)(y,{className:"max-w-md bg-slate-900 text-blue-100 border border-blue-700",children:[(0,l.jsx)(w,{children:(0,l.jsx)(S,{className:"text-blue-300",children:"Add New Station"})}),(0,l.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"stationName",className:"font-semibold text-blue-200",children:"Station Name"}),(0,l.jsx)(C,{id:"stationName",name:"stationName",placeholder:"e.g., Neo Nexus Refinery",value:n,onChange:e=>i(e.target.value),required:!0,className:"bg-slate-800 text-blue-100 border-blue-700 mt-1"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"stationId",className:"font-semibold text-blue-200",children:"Station ID"}),(0,l.jsx)(C,{id:"stationId",name:"stationId",type:"number",placeholder:"e.g., 1024012922938",value:o,onChange:e=>d(e.target.value),required:!0,className:"bg-slate-800 text-blue-100 border-blue-700 mt-1"})]}),c&&(0,l.jsx)("div",{className:"mt-2 font-semibold ".concat(c.success?"text-green-400":"text-red-400"),children:c.message}),(0,l.jsxs)(_,{className:"gap-2",children:[(0,l.jsx)(x,{type:"submit",disabled:m,className:"bg-gradient-to-r from-blue-700 via-blue-900 to-blue-800 text-white font-bold",children:m?"Adding...":"Add Station"}),(0,l.jsx)(x,{type:"button",variant:"secondary",onClick:p,className:"bg-slate-700 text-blue-200 hover:bg-slate-600",children:"Close"})]})]})]})})}function O(e){let{open:t,onOpenChange:a,stations:s,loading:r,error:n,onEditStation:i,onDeleteStation:o}=e;return(0,l.jsx)(f,{open:t,onOpenChange:a,children:(0,l.jsxs)(y,{className:"max-w-lg bg-slate-900 text-blue-100 border border-blue-700",children:[(0,l.jsx)(w,{children:(0,l.jsx)(S,{className:"text-blue-300",children:"Stations"})}),(0,l.jsxs)("div",{className:"space-y-4 max-h-[50vh] overflow-y-auto",children:[r&&(0,l.jsx)("div",{children:"Loading stations..."}),n&&(0,l.jsx)("div",{className:"text-red-400",children:n}),!r&&!n&&0===s.length&&(0,l.jsx)("div",{className:"text-blue-400",children:"No stations added yet."}),!r&&!n&&s.length>0&&(0,l.jsxs)("table",{className:"w-full text-left border-separate border-spacing-y-2",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"pr-2",children:"Name"}),(0,l.jsx)("th",{className:"pr-2",children:"ID"}),(0,l.jsx)("th",{className:"pr-2",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:s.map(e=>(0,l.jsxs)("tr",{className:"bg-slate-800 rounded",children:[(0,l.jsx)("td",{className:"pr-2",children:e.name}),(0,l.jsx)("td",{className:"pr-2",children:e.station_id}),(0,l.jsxs)("td",{className:"flex gap-2",children:[(0,l.jsx)(x,{size:"sm",variant:"secondary",className:"bg-blue-700 text-white",onClick:()=>i(e),children:"Edit"}),o&&(0,l.jsx)(x,{size:"sm",variant:"destructive",onClick:()=>o(e.id),children:"Delete"})]})]},e.id))})]})]}),(0,l.jsx)(_,{children:(0,l.jsx)(x,{variant:"secondary",onClick:()=>a(!1),children:"Close"})})]})})}function P(e){let{open:t,onOpenChange:a,station:s,onStationUpdate:n}=e,[i,o]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[u,m]=(0,r.useState)(null),[b,h]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{if(s)o(s.name),c(s.station_id.toString()),m(null);else{o(""),c(""),m(null);return}},[s,t]),!s)return null;let p=async e=>{if(e.preventDefault(),h(!0),m(null),!i.trim()||!d.trim()){m({success:!1,message:"Name and Station ID cannot be empty"}),h(!1);return}try{let e=await fetch("/api/stations/".concat(s.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:i.trim(),station_id:parseInt(d,10)})});if(e.ok)m({success:!0,message:"✅ Station updated successfully!"}),n&&n({...s,name:i,station_id:parseInt(d,10)}),setTimeout(()=>a(!1),1500);else{let t=await e.json();m({success:!1,message:"❌ Error updating station: ".concat(t.error||"Unknown error")})}}catch(e){m({success:!1,message:"❌ Error updating station: ".concat(e instanceof Error?e.message:"Unknown error")})}finally{h(!1)}},g=()=>{m(null),a(!1)};return(0,l.jsx)(f,{open:t,onOpenChange:g,children:(0,l.jsxs)(y,{className:"max-w-md bg-slate-900 text-blue-100 border border-blue-700",children:[(0,l.jsx)(w,{children:(0,l.jsx)(S,{className:"text-blue-300",children:"Edit Station"})}),(0,l.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"editStationName",className:"font-semibold text-blue-200",children:"Name"}),(0,l.jsx)(C,{id:"editStationName",value:i,onChange:e=>o(e.target.value),required:!0,className:"bg-slate-800 text-blue-100 border-blue-700 mt-1"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"editStationStationId",className:"font-semibold text-blue-200",children:"Station ID"}),(0,l.jsx)(C,{id:"editStationStationId",type:"number",value:d,onChange:e=>c(e.target.value),required:!0,className:"bg-slate-800 text-blue-100 border-blue-700 mt-1"})]}),u&&(0,l.jsx)("div",{className:"mt-2 font-semibold ".concat(u.success?"text-green-400":"text-red-400"),children:u.message}),(0,l.jsxs)(_,{className:"gap-2",children:[(0,l.jsx)(x,{type:"submit",disabled:b,className:"bg-gradient-to-r from-blue-700 via-blue-900 to-blue-800 text-white font-bold",children:b?"Saving...":"Save"}),(0,l.jsx)(x,{type:"button",variant:"secondary",onClick:g,className:"bg-slate-700 text-blue-200",children:"Cancel"})]})]})]})})}function M(e){let{stations:t,loading:a=!1,error:s=null,onEdit:r,onDelete:n}=e;return a?(0,l.jsx)("div",{className:"text-blue-200 p-6 text-center",children:"Loading stations..."}):s?(0,l.jsx)("div",{className:"text-red-400 p-6 text-center",children:s}):t.length?(0,l.jsxs)("table",{className:"w-full text-left border-separate border-spacing-y-2",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"pr-2 py-2 text-blue-400",children:"Name"}),(0,l.jsx)("th",{className:"pr-2 py-2 text-blue-400",children:"ID"}),(0,l.jsx)("th",{className:"pr-2 py-2 text-blue-400 text-center",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:t.map(e=>(0,l.jsxs)("tr",{className:"bg-slate-800/80 hover:bg-blue-900/50 transition rounded-xl",children:[(0,l.jsx)("td",{className:"pr-2 py-2 rounded-l-xl font-semibold text-blue-100",children:e.name}),(0,l.jsx)("td",{className:"pr-2 py-2 text-blue-300",children:e.station_id}),(0,l.jsxs)("td",{className:"pr-2 py-2 rounded-r-xl flex gap-2 justify-center",children:[r&&(0,l.jsx)(x,{size:"sm",variant:"secondary",className:"bg-blue-700 text-white hover:bg-blue-800 transition",onClick:()=>r(e),children:"Edit"}),n&&(0,l.jsx)(x,{size:"sm",variant:"destructive",className:"hover:bg-red-700 transition",onClick:()=>n(e.id),children:"Delete"})]})]},e.id))})]}):(0,l.jsx)("div",{className:"text-blue-400 p-6 text-center",children:"No stations added yet."})}function I(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"card",className:c("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function A(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"card-header",className:c("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function z(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"card-title",className:c("leading-none font-semibold",t),...a})}function R(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"card-description",className:c("text-muted-foreground text-sm",t),...a})}function B(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"card-content",className:c("px-6",t),...a})}var L=a(3478),D=a(6474);function U(e){let{...t}=e;return(0,l.jsx)(L.bL,{"data-slot":"accordion",...t})}function q(e){let{className:t,...a}=e;return(0,l.jsx)(L.q7,{"data-slot":"accordion-item",className:c("border-b last:border-b-0",t),...a})}function J(e){let{className:t,children:a,...s}=e;return(0,l.jsx)(L.Y9,{className:"flex",children:(0,l.jsxs)(L.l9,{"data-slot":"accordion-trigger",className:c("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",t),...s,children:[a,(0,l.jsx)(D.A,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function V(e){let{className:t,children:a,...s}=e;return(0,l.jsx)(L.UC,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...s,children:(0,l.jsx)("div",{className:c("pt-0 pb-4",t),children:a})})}function K(){let[e,t]=(0,r.useState)(!1),[a,s]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)([]),[c,u]=(0,r.useState)(!0),[m,b]=(0,r.useState)(null),[h,p]=(0,r.useState)(null),[g,f]=(0,r.useState)(!1);async function j(){u(!0),console.log("MSW ready. Requesting /api/stations");try{let e=await fetch("/api/stations");if(!e.ok)throw Error("HTTP ".concat(e.status));let t=await e.json();d(t)}catch(e){console.error("Failed to fetch stations:",e)}finally{u(!1)}}(0,r.useEffect)(()=>{j()},[]);let v=e=>{p(e),i(!0)},N=async e=>{try{let t=await fetch("/api/stations/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.name,station_id:e.station_id})});if(!t.ok)throw Error("Failed to update station, status ".concat(t.status));await j()}catch(e){console.error("Error updating station:",e)}},y=async e=>{if(window.confirm("Are you sure you want to delete this station?"))try{let t=await fetch("/api/stations/".concat(e),{method:"DELETE"});if(t.ok)d(t=>t.filter(t=>t.id!==e));else{let e=await t.json();alert("Error: "+(e.error||"Unknown error"))}}catch(e){alert("Error: "+(e instanceof Error?e.message:"Unknown error"))}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(I,{className:"h-full rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full",children:[(0,l.jsx)(A,{className:"px-6 pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(z,{className:"text-2xl text-blue-100",children:"Your Stations"}),(0,l.jsx)(R,{className:"text-blue-400",children:"Manage your selling stations. (If none, Jita will be used)"})]}),(0,l.jsx)(x,{onClick:()=>t(!0),className:"bg-gradient-to-r from-blue-700 via-blue-900 to-blue-800 text-white hover:from-blue-800 hover:to-blue-900 scale-120 relative right-2",children:"+ Add Station"})]})}),(0,l.jsx)(B,{className:"px-6 pb-6",children:(0,l.jsx)(U,{type:"single",collapsible:!0,children:(0,l.jsxs)(q,{value:"stations",className:"border-none bg-slate-900/60 rounded-xl overflow-hidden",children:[(0,l.jsx)(J,{className:"text-blue-200 text-lg font-bold tracking-wide rounded-xl px-4 py-3 bg-blue-900/80 hover:bg-blue-800/80 hover:no-underline shadow transition-all",children:"View Station List"}),(0,l.jsx)(V,{className:"bg-slate-900/80 px-2 pb-4 pt-2 rounded-b-xl",children:(0,l.jsx)(M,{stations:o,loading:c,error:m,onEdit:v,onDelete:y})})]})})})]}),(0,l.jsx)(O,{open:a,onOpenChange:s,stations:o,loading:c,error:m,onEditStation:v}),h&&(0,l.jsx)(P,{open:n,onOpenChange:i,station:h,onStationUpdate:N}),(0,l.jsx)(E,{open:e,onOpenChange:t})]})}var W=a(7863),Y=a(9917),H=a(2525),Q=a(133);function Z(e){return e>=1e9?(e/1e9).toFixed(2)+"b":e>=1e6?(e/1e6).toFixed(2)+"m":e>=1e3?(e/1e3).toFixed(2)+"k":e.toString()}function $(e){let{onDelete:t,children:a}=e,[s,n]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(!s)return;let e=setTimeout(()=>n(!1),3e3);return()=>clearTimeout(e)},[s]),(0,l.jsx)(x,{size:"sm",variant:"destructive",onClick:()=>{s?(t(),n(!1)):n(!0)},className:"transition-colors ".concat(s?"bg-red-700 hover:bg-red-900":"bg-red-600 hover:bg-red-800"),children:s?"Confirm Delete?":a})}function G(e){return e.toLocaleString()+" ISK"}function X(e){let{materials:t}=e;if(!t||0===t.length)return(0,l.jsx)("div",{className:"text-gray-400 italic",children:"No materials"});let a=t.reduce((e,t)=>{if(!t)return e;let a=t.category||"Other";return e[a]||(e[a]={}),e[a][t.name]=t.quantity,e},{});return(0,l.jsx)("ul",{className:"list-none pl-0 m-0 text-xs",children:Object.entries(a).map(e=>{let[t,a]=e;return(0,l.jsxs)("li",{children:[(0,l.jsx)("span",{className:"font-semibold",children:t}),(0,l.jsx)("ul",{className:"list-none pl-3",children:Object.entries(a).map(e=>{let[t,a]=e;return(0,l.jsxs)("li",{children:[(0,l.jsx)("span",{className:"text-accent",children:t}),": ",a]},t)})})]},t)})})}function ee(e){let{blueprints:t,onEdit:a,onSetBlueprints:n,loading:i,fetchBlueprints:o}=e,[d,c]=(0,r.useState)({}),[u,m]=(0,r.useState)({}),[b,h]=(0,r.useState)({key:"name",direction:"asc"}),[p,g]=(0,r.useState)({key:"name",direction:"asc"}),[f,j]=(0,r.useState)("");function v(e){return"T2"===e.tier}let[N,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(window.__msw)y(!0);else{let e=setInterval(()=>{window.__msw&&(clearInterval(e),y(!0))},50)}},[]);let w=async e=>{(await fetch("/api/blueprints/blueprint/".concat(e),{method:"DELETE"})).ok?(s.oR.success("Blueprint deleted"),null==o||o()):s.oR.error("Failed to delete blueprint")},_=async e=>{if(!n)return;console.log("Resetting max value for blueprint",e);let t=await fetch("/api/blueprints/blueprint/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({max:null})});t.ok?(n(t=>t.map(t=>t.id===e?{...t,max:null}:t)),c(t=>{let a={...t};return delete a[e],a}),console.log("Toast triggered for individual reset"),s.oR.success("Blueprint max value reset")):(console.error("Failed to reset max value: "+t.statusText),s.oR.error("Failed to reset max value"))},S=async e=>{if(!n)return;m(t=>({...t,[e]:!0})),console.log("Resetting all max values for tier",e);let t=await fetch("/api/blueprints/blueprints/reset_max",{method:"POST"});t.ok?(console.log("All max values reset"),s.oR.success("All max values reset"),n(e=>e.map(e=>({...e,max:null}))),c({})):(console.error("Failed to reset all max values"+t.statusText),s.oR.error("Failed to reset all max values")),m(t=>({...t,[e]:!1}))},k=(e,t)=>{c(a=>({...a,[e]:t}))},T=async e=>{let t=d[e];if(""===t||null==t)return;let a=parseInt(t,10);isNaN(a)||((await fetch("/api/blueprints/blueprint/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({max:a})})).ok?s.oR.success("Max value updated"):s.oR.error("Failed to update max value"))};function F(e,t){return[...e].sort((e,a)=>{var l,s,r,n;let i="asc"===t.direction?1:-1;switch(t.key){case"name":return e.name.localeCompare(a.name)*i;case"sell_price":return(e.sell_price-a.sell_price)*i;case"material_cost":return(e.material_cost-a.material_cost)*i;case"full_material_cost":return(("T2"===e.tier?e.full_material_cost:e.material_cost)-("T2"===a.tier?a.full_material_cost:a.material_cost))*i;case"profit":return(e.sell_price-("T2"===e.tier?e.full_material_cost:e.material_cost)-(a.sell_price-("T2"===a.tier?a.full_material_cost:a.material_cost)))*i;case"profit_percent":{let t="T2"===e.tier?e.full_material_cost:e.material_cost,l="T2"===a.tier?a.full_material_cost:a.material_cost;return((t>0?(e.sell_price-t)/t*100:0)-(l>0?(a.sell_price-l)/l*100:0))*i}case"station_name":return((null==(l=e.station)?void 0:l.name)||e.station_name||"Jita 4-4").localeCompare((null==(s=a.station)?void 0:s.name)||a.station_name||"Jita 4-4")*i;case"max":return((null!=(r=e.max)?r:0)-(null!=(n=a.max)?n:0))*i;case"invention_chance":return(("T2"===e.tier?e.invention_chance:0)-("T2"===a.tier?a.invention_chance:0))*i;default:return 0}})}function E(e,t){let a=t.trim().toLowerCase();return a?e.filter(e=>{var t,l,s;let r=e.sell_price,n=e.material_cost,i=r-n,o=n>0?(i/n*100).toFixed(2):"-",d=(null==(t=e.name)?void 0:t.toLowerCase().includes(a))||(null==(l=e.station_name)?void 0:l.toLowerCase().includes(a))||String(r).includes(a)||String(n).includes(a)||String(i).includes(a)||o.includes(a)||String(null!=(s=e.max)?s:"").includes(a),c=!!Array.isArray(e.materials)&&e.materials.some(e=>{var t;return(null==(t=e.name)?void 0:t.toLowerCase().includes(a))||String(e.quantity).includes(a)});if("T2"===e.tier){let t=r-e.full_material_cost,l=e.full_material_cost>0?(t/e.full_material_cost*100).toFixed(2):"-",s=String(e.full_material_cost).includes(a)||String(e.invention_chance).includes(a)||String(t).includes(a)||l.includes(a);return d||s||c}return d||c}):e}let O=t.filter(e=>"T1"===e.tier),P=t.filter(v),M=E(O,f),I=E(P,f);function A(e,t,a,s){return(0,l.jsx)("tr",{className:"T2"===a?"text-orange-400":"text-blue-400",children:e.map(e=>{let a=["name","sell_price","material_cost","full_material_cost","profit","profit_percent","station_name","max","invention_chance"].includes(e.key),r=t.key===e.key;return(0,l.jsx)("th",{className:"py-2 px-3 text-left ".concat(a?"cursor-pointer select-none hover:underline":""),onClick:()=>a&&s({key:e.key,direction:r&&"asc"===t.direction?"desc":"asc"}),children:(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[e.label,a&&r?"asc"===t.direction?(0,l.jsx)(D.A,{className:"w-4 h-4 inline"}):(0,l.jsx)(W.A,{className:"w-4 h-4 inline"}):null]})},e.key)})})}return(0,l.jsxs)(B,{children:[(0,l.jsx)(R,{children:(0,l.jsx)("div",{className:"mb-4 flex justify-between items-center gap-4",children:(0,l.jsx)(C,{type:"text",placeholder:"Search blueprints...",value:f,onChange:e=>j(e.target.value),className:"w-full max-w-md bg-blue-900 text-blue-200 border-blue-700"})})}),(0,l.jsxs)(U,{type:"multiple",className:"mb-4",children:[(0,l.jsxs)(q,{value:"t1",defaultChecked:!0,children:[(0,l.jsx)(J,{className:"text-lg font-semibold text-blue-100 bg-gradient-to-r from-blue-800 via-blue-700 to-blue-900 hover:no-underline rounded-t-xl rounded-b-none px-4 py-3",style:{borderBottom:"2px solid #60a5fa",boxShadow:"0 2px 8px 0 #2563eb22"},children:(0,l.jsx)("span",{className:"text-blue-200",children:"Tier 1 Blueprints"})}),(0,l.jsx)(V,{className:"bg-gradient-to-br from-blue-950 via-blue- to-slate-950 hover:no-underline rounded-b-xl px-2 pb-4 pt-2",children:M.length?(0,l.jsxs)("div",{className:"overflow-x-auto",children:[(0,l.jsxs)("table",{className:"min-w-full text-sm bg-blue-950/70 rounded-xl shadow",children:[(0,l.jsx)("thead",{children:A([{key:"name",label:"Name"},{key:"sell_price",label:"Sell Price"},{key:"material_cost",label:"Material Cost"},{key:"materials",label:"Materials"},{key:"profit_percent",label:"Profit %"},{key:"station_name",label:"Station"},{key:"max",label:"Max"},{key:"actions",label:"Actions"}],b,"T1",h)}),(0,l.jsx)("tbody",{children:F(M,b).map(e=>{var t,s,r;let n=Math.round(e.sell_price),i=Math.round(e.material_cost),o=n-i,c=i>0?(o/i*100).toFixed(2):"-";return(0,l.jsxs)("tr",{className:"border-b border-blue-800 hover:bg-blue-900/60 text-blue-200 transition",children:[(0,l.jsx)("td",{className:"py-2 px-3 font-semibold",children:e.name}),(0,l.jsxs)("td",{className:"py-2 px-3",children:[G(n)," ",(0,l.jsxs)("span",{className:"text-xs text-blue-400 ml-1",children:["(",Z(n)," isk)"]}),e.used_jita_fallback&&(0,l.jsx)("span",{className:"ml-2 text-orange-400",title:"Fallback to Jita pricing",children:"⚠"})]}),(0,l.jsxs)("td",{className:"py-2 px-3",children:[G(i)," ",(0,l.jsxs)("span",{className:"text-xs text-blue-400 ml-1",children:["(",Z(i)," isk)"]})]}),(0,l.jsx)("td",{className:"py-2 px-3",children:(0,l.jsx)(X,{materials:e.materials})}),(0,l.jsxs)("td",{className:"py-2 px-3 text-center",children:[c,"%"]}),(0,l.jsx)("td",{className:"py-2 px-3 text-center",children:e.station_name||(null==(t=e.station)?void 0:t.name)||"Jita 4-4"}),(0,l.jsx)("td",{className:"py-2 px-3 text-center",children:(0,l.jsx)(C,{type:"number",value:null!=(r=d[e.id])?r:null!=(s=e.max)?s:"",onChange:t=>k(e.id,t.target.value),onBlur:()=>T(e.id),className:"w-16 text-center bg-blue-900 border-blue-700"})}),(0,l.jsx)("td",{className:"py-2 px-3 text-center",children:(0,l.jsxs)("div",{className:"flex flex-col gap-2 items-stretch",children:[(0,l.jsxs)(x,{size:"sm",variant:"secondary",className:"bg-blue-700 text-white",onClick:()=>null==a?void 0:a(e,"T1"),children:[(0,l.jsx)(Y.A,{className:"w-4 h-4 mr-1"})," Edit"]}),(0,l.jsxs)($,{onDelete:()=>w(e.id),children:[(0,l.jsx)(H.A,{className:"w-4 h-4 mr-1"})," Delete"]}),(0,l.jsxs)(x,{size:"sm",variant:"outline",className:"border-blue-500 text-blue-700 bg-blue-200",onClick:()=>_(e.id),children:[(0,l.jsx)(Q.A,{className:"w-4 h-4 mr-1"})," Reset Max"]})]})})]},e.id)})})]}),(0,l.jsx)("div",{className:"flex justify-end mt-3",children:(0,l.jsxs)(x,{variant:"outline",className:"border-blue-500 text-blue-700 bg-blue-50",onClick:()=>S("T1"),disabled:!!u.T1,children:[(0,l.jsx)(Q.A,{className:"w-4 h-4 mr-2"}),u.T1?"Resetting...":"Reset All Max Values"]})})]}):(0,l.jsx)("div",{className:"p-6 text-blue-400",children:"No Tier 1 blueprints found."})})]}),(0,l.jsxs)(q,{value:"t2",children:[(0,l.jsx)(J,{className:"text-lg font-semibold bg-gradient-to-r from-orange-400 via-orange-500 to-yellow-500 text-orange-900 hover:no-underline rounded-t-none px-4 py-3",style:{borderBottom:"2px solid #f59e42",boxShadow:"0 2px 8px 0 #f59e4222"},children:(0,l.jsx)("span",{className:"text-[#fcf2e2]",children:"Tier 2 Blueprints"})}),(0,l.jsx)(V,{className:"bg-[#2d1e13] rounded-b-xl px-2 pb-4 pt-2 border-l-[8px] border-[#ff9800] shadow-[0_4px_20px_0_rgba(200,120,30,0.13)]",children:I.length?(0,l.jsxs)("div",{className:"overflow-x-auto",children:[(0,l.jsxs)("table",{className:"min-w-full text-sm bg-[#2d1e13] rounded-xl shadow",children:[(0,l.jsx)("thead",{children:A([{key:"name",label:"Name"},{key:"invention_chance",label:"Invention Chance %"},{key:"sell_price",label:"Sell Price"},{key:"full_material_cost",label:"Full Material Cost"},{key:"materials",label:"Materials"},{key:"profit_percent",label:"Profit %"},{key:"station_name",label:"Station"},{key:"max",label:"Max"},{key:"actions",label:"Actions"}],p,"T2",g)}),(0,l.jsx)("tbody",{children:F(I,p).map(e=>{if(!v(e))return console.log("Blueprint ".concat(e.id," is not Tier 2!")),null;{var t,s,r,n;e.material_cost;let i=Math.round(e.sell_price),o=Math.round(null!=(s=e.full_material_cost)?s:e.material_cost),c=i-o,u=o>0?(c/o*100).toFixed(2):"-";return(0,l.jsxs)("tr",{className:"border-b border-[#ff9800] hover:bg-[#5a492f] text-amber-100 transition",children:[(0,l.jsx)("td",{className:"py-2 px-3 font-semibold text-[#e8d5b9]",children:e.name}),(0,l.jsx)("td",{className:"py-2 px-3 text-center text-[#fff1dc]",children:null!=e.invention_chance?(100*e.invention_chance).toFixed(1)+"%":"-"}),(0,l.jsxs)("td",{className:"py-2 px-3 text-[#ffedd1]",children:[G(i)," ",(0,l.jsxs)("span",{className:"text-xs text-[#d57d00] ml-1",children:["(",Z(i)," isk)"]}),e.used_jita_fallback&&(0,l.jsx)("span",{className:"ml-2 text-[#d57d00]",title:"Fallback to Jita pricing",children:"⚠"})]}),(0,l.jsxs)("td",{className:"py-2 px-3 text-[#ffedd1]",children:[G(o)," ",(0,l.jsxs)("span",{className:"text-xs text-[#d57d00] ml-1",children:["(",Z(o)," isk)"]})]}),(0,l.jsx)("td",{className:"py-2 px-3",children:(0,l.jsx)(X,{materials:e.materials})}),(0,l.jsxs)("td",{className:"py-2 px-3 text-center text-[#ffeed4]",children:[u,"%"]}),(0,l.jsx)("td",{className:"py-2 px-3 text-center text-[#ffedd1]",children:e.station_name||(null==(t=e.station)?void 0:t.name)||"Jita 4-4"}),(0,l.jsx)("td",{className:"py-2 px-3 text-center",children:(0,l.jsx)(C,{type:"number",value:null!=(n=d[e.id])?n:null!=(r=e.max)?r:"",onChange:t=>k(e.id,t.target.value),onBlur:()=>T(e.id),className:"w-16 text-center bg-[#3a2719] border-[#e08900] text-[##ffedd1]"})}),(0,l.jsx)("td",{className:"py-2 px-3 text-center",children:(0,l.jsxs)("div",{className:"flex flex-col gap-2 items-stretch",children:[(0,l.jsxs)(x,{size:"sm",variant:"secondary",className:"bg-[#e08900] text-white hover:bg-[#f09a00]",onClick:()=>null==a?void 0:a(e,"T2"),children:[(0,l.jsx)(Y.A,{className:"w-4 h-4 mr-1"})," Edit"]}),(0,l.jsxs)($,{onDelete:()=>w(e.id),children:[(0,l.jsx)(H.A,{className:"w-4 h-4 mr-1"})," Delete"]}),(0,l.jsxs)(x,{size:"sm",variant:"outline",className:"border-[#e08900] text-[#bf7404] bg-amber-100",onClick:()=>_(e.id),children:[(0,l.jsx)(Q.A,{className:"w-4 h-4 mr-1"})," Reset Max"]})]})})]},e.id)}})})]}),(0,l.jsx)("div",{className:"flex justify-end mt-3",children:(0,l.jsxs)(x,{variant:"outline",className:"border-[#e08900] text-[#ce7c00] bg-amber-50",onClick:()=>S("T2"),disabled:!!u.T2,children:[(0,l.jsx)(Q.A,{className:"w-4 h-4 mr-2"}),u.T2?"Resetting...":"Reset All Max Values"]})})]}):(0,l.jsx)("div",{className:"p-6 text-[#d57d00]",children:"No Tier 2 blueprints found."})})]})]}),(0,l.jsxs)("div",{className:"price-legend mt-2 text-sm text-[#ff9500]",children:[(0,l.jsx)("span",{className:"text-orange-400",children:"⚠"})," Fallback to Jita pricing"]})]})}var et=a(1146),ea=a(5196);function el(e){let{...t}=e;return(0,l.jsx)(et.bL,{"data-slot":"select",...t})}function es(e){let{...t}=e;return(0,l.jsx)(et.WT,{"data-slot":"select-value",...t})}function er(e){let{className:t,size:a="default",children:s,...r}=e;return(0,l.jsxs)(et.l9,{"data-slot":"select-trigger","data-size":a,className:c("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...r,children:[s,(0,l.jsx)(et.In,{asChild:!0,children:(0,l.jsx)(D.A,{className:"size-4 opacity-50"})})]})}function en(e){let{className:t,children:a,position:s="popper",...r}=e;return(0,l.jsx)(et.ZL,{children:(0,l.jsxs)(et.UC,{"data-slot":"select-content",className:c("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...r,children:[(0,l.jsx)(eo,{}),(0,l.jsx)(et.LM,{className:c("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,l.jsx)(ed,{})]})})}function ei(e){let{className:t,children:a,...s}=e;return(0,l.jsxs)(et.q7,{"data-slot":"select-item",className:c("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[(0,l.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,l.jsx)(et.VF,{children:(0,l.jsx)(ea.A,{className:"size-4"})})}),(0,l.jsx)(et.p4,{children:a})]})}function eo(e){let{className:t,...a}=e;return(0,l.jsx)(et.PP,{"data-slot":"select-scroll-up-button",className:c("flex cursor-default items-center justify-center py-1",t),...a,children:(0,l.jsx)(W.A,{className:"size-4"})})}function ed(e){let{className:t,...a}=e;return(0,l.jsx)(et.wn,{"data-slot":"select-scroll-down-button",className:c("flex cursor-default items-center justify-center py-1",t),...a,children:(0,l.jsx)(D.A,{className:"size-4"})})}function ec(e){let{open:t,blueprint:a,tier:s,onClose:n,onSave:i}=e,[o,d]=r.useState(null),[c,u]=(0,r.useState)([]);if((0,r.useEffect)(()=>{async function e(){try{let e=await fetch("/api/stations"),t=await e.json();u(t)}catch(e){console.error("Failed to fetch stations:",e)}}t&&e()},[t]),(0,r.useEffect)(()=>{a&&d(a)},[a]),!o)return null;function m(e){let{name:t,value:a}=e.target;d(e=>e?{...e,[t]:"sell_price"===t||"material_cost"===t?parseFloat(a):a}:e)}let b={T1:{modal:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border border-blue-800 shadow-2xl text-white",label:"text-[#a0c4ff] mb-1",input:"bg-slate-800 border border-blue-800 text-white focus:ring-blue-400 focus:border-blue-400",selectTrigger:"bg-slate-800 border border-blue-800 text-white focus:ring-blue-400 focus:border-blue-400",selectContent:"bg-slate-900 text-white",buttonPrimary:"bg-blue-700 hover:bg-blue-500 focus:ring-blue-500 text-white",buttonSecondary:"bg-slate-900 text-blue-300 hover:bg-blue-700",title:"text-blue-300"},T2:{modal:"rounded-2xl bg-gradient-to-br from-yellow-900 via-amber-900 to-orange-950 border border-amber-700 shadow-2xl text-[#f0e4c1]",label:"text-[#f9d58b] mb-1",input:"bg-[#5c3b0d] border border-amber-700 text-[#f0e4c1] focus:ring-amber-400 focus:border-amber-400",selectTrigger:"bg-[#5c3b0d] border border-amber-700 text-[#f0e4c1] focus:ring-amber-400 focus:border-amber-400",selectContent:"bg-[#3e2f0f] text-[#f0e4c1]",buttonPrimary:"bg-amber-700 hover:bg-amber-500 focus:ring-amber-500 text-[#0c0802]",buttonSecondary:"bg-[#3b2e08] text-amber-500 hover:bg-amber-900",title:"text-amber-400"}}[o.tier||"T1"];return(0,l.jsx)(f,{open:t,onOpenChange:e=>!e&&n(),children:(0,l.jsxs)(y,{className:"max-w-lg rounded-lg shadow-lg overflow-hidden ".concat(b.modal),children:[(0,l.jsx)(w,{children:(0,l.jsx)(S,{className:"text-2xl font-semibold ".concat(b.title),children:"Edit Blueprint"})}),(0,l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o&&i(o)},className:"space-y-6 overflow-x-hidden",children:[(0,l.jsx)(C,{type:"hidden",name:"id",value:o.id}),(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"editBlueprintName",className:b.label,children:"Blueprint Name"}),(0,l.jsx)(C,{id:"editBlueprintName",name:"name",value:o.name,onChange:m,required:!0,className:"".concat(b.input," w-full")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"editBlueprintSellPrice",className:b.label,children:"Sell Price"}),(0,l.jsx)(C,{id:"editBlueprintSellPrice",name:"sell_price",type:"number",step:"0.01",value:o.sell_price,onChange:m,required:!0,className:"".concat(b.input," w-full")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"editBlueprintCost",className:b.label,children:"Material Cost"}),(0,l.jsx)(C,{id:"editBlueprintCost",name:"material_cost",type:"number",step:"0.01",value:o.material_cost,onChange:m,required:!0,className:"".concat(b.input," w-full")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"editBlueprintStation",className:b.label,children:"Manufacturing Station"}),(0,l.jsxs)("select",{id:"editBlueprintStation",name:"station_id",value:o.station_id||"",onChange:m,className:"".concat(b.input," w-full rounded-md py-2 px-1.5"),children:[(0,l.jsx)("option",{value:"",children:"None (Use Jita)"}),c.map(e=>(0,l.jsxs)("option",{value:e.station_id,children:[e.name," (",e.station_id,")"]},e.station_id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"editBlueprintTier",className:b.label,children:"Tier"}),(0,l.jsxs)(el,{value:o.tier,onValueChange:function(e){d(t=>{if(!t)return t;if("T2"===e)return"T1"===t.tier?{...t,tier:"T2",invention_chance:0,invention_cost:0,full_material_cost:t.material_cost,runs_per_copy:10}:t;if("T2"===t.tier){let{invention_chance:e,invention_cost:a,full_material_cost:l,runs_per_copy:s,...r}=t;return{...r,tier:"T1"}}return t})},children:[(0,l.jsx)(er,{id:"editBlueprintTier",className:"".concat(b.selectTrigger," w-full"),children:(0,l.jsx)(es,{})}),(0,l.jsxs)(en,{className:b.selectContent,children:[(0,l.jsx)(ei,{value:"T1",children:"Tier 1"}),(0,l.jsx)(ei,{value:"T2",children:"Tier 2"})]})]})]}),"T2"===o.tier&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"editBlueprintInventionChance",className:b.label,children:"Invention Chance (%)"}),(0,l.jsx)(C,{id:"editBlueprintInventionChance",name:"invention_chance",type:"number",min:0,max:100,step:.1,value:o.invention_chance?100*o.invention_chance:"",onChange:function(e){let t=e.target.value;d(e=>e&&"T2"===e.tier?{...e,invention_chance:t?parseFloat(t)/100:0}:e)},className:"".concat(b.input," w-full")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{htmlFor:"editBlueprintRunsPerCopy",className:b.label,children:"Runs per Invented Copy"}),(0,l.jsxs)(el,{value:String(o.runs_per_copy||10),onValueChange:function(e){d(t=>t?{...t,runs_per_copy:parseInt(e,10)}:t)},children:[(0,l.jsx)(er,{id:"editBlueprintRunsPerCopy",className:"".concat(b.selectTrigger," w-full"),children:(0,l.jsx)(es,{})}),(0,l.jsxs)(en,{className:b.selectContent,children:[(0,l.jsx)(ei,{value:"10",children:"10 Runs"}),(0,l.jsx)(ei,{value:"1",children:"1 Run"})]})]})]})]}),(0,l.jsxs)(_,{children:[(0,l.jsx)(x,{type:"submit",className:b.buttonPrimary,children:"Save Changes"}),(0,l.jsx)(v,{asChild:!0,children:(0,l.jsx)(x,{type:"button",variant:"secondary",className:b.buttonSecondary,children:"Cancel"})})]})]})]})})}function eu(e){let{className:t,...a}=e;return(0,l.jsx)("textarea",{"data-slot":"textarea",className:c("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}var ex=a(7701),em=a(9428);function eb(e){let{className:t,...a}=e;return(0,l.jsx)(ex.bL,{"data-slot":"radio-group",className:c("grid gap-3",t),...a})}function eh(e){let{className:t,...a}=e;return(0,l.jsx)(ex.q7,{"data-slot":"radio-group-item",className:c("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,l.jsx)(ex.C1,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,l.jsx)(em.A,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}var ep=a(1243),eg=a(3453),ef=a(7655);function ej(e){let{className:t,children:a,...s}=e;return(0,l.jsxs)(ef.bL,{"data-slot":"scroll-area",className:c("relative",t),...s,children:[(0,l.jsx)(ef.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),(0,l.jsx)(ev,{}),(0,l.jsx)(ef.OK,{})]})}function ev(e){let{className:t,orientation:a="vertical",...s}=e;return(0,l.jsx)(ef.VM,{"data-slot":"scroll-area-scrollbar",orientation:a,className:c("flex touch-none p-px transition-colors select-none","vertical"===a&&"h-full w-2.5 border-l border-l-transparent","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent",t),...s,children:(0,l.jsx)(ef.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}let eN={T1:{modal:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border border-blue-800 shadow-2xl text-white",label:"text-blue-300",input:"bg-slate-800 border border-blue-700 text-blue-100 placeholder:text-blue-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",li:"text-blue-100",dropdown:"bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border border-blue-800 text-blue-100 shadow-lg rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",dropdownItem:"px-4 py-2 rounded-md text-blue-100 hover:bg-blue-800 hover:text-blue-200 focus:bg-blue-900 focus:text-white cursor-pointer transition-colors",selectTrigger:"bg-slate-800 border border-blue-700 text-blue-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",selectContent:"bg-slate-900 text-white",buttonPrimary:"bg-blue-600 hover:bg-blue-500 focus:ring-2 focus:ring-blue-400 text-white font-semibold",buttonSecondary:"bg-slate-800 text-blue-300 hover:bg-blue-800 hover:text-white border border-blue-700",title:"text-blue-300",description:"text-blue-400"},T2:{modal:"rounded-2xl bg-gradient-to-br from-yellow-950 via-amber-900 to-orange-950 border border-amber-700 shadow-2xl text-[#f0e4c1]",label:"text-amber-300",input:"bg-[#4a2e08] border border-amber-600 text-[#f0e4c1] placeholder:text-amber-300 focus:ring-2 focus:ring-amber-400 focus:border-amber-400 ",li:"text-amber-100",dropdown:"bg-[#4a2e08] border border-amber-700 text-[#f0e4c1] shadow-lg rounded-xl focus:ring-2 px-3 focus:ring-amber-400 focus:border-amber-400",dropdownItem:"px-4 py-2 rounded-md text-amber-100 hover:bg-amber-900 hover:text-amber-200 focus:bg-amber-950 focus:text-white cursor-pointer transition-colors",selectTrigger:"bg-[#4a2e08] border border-amber-600 text-[#f0e4c1] focus:ring-2 focus:ring-amber-400 focus:border-amber-400",selectContent:"bg-[#3e2f0f] text-[#f0e4c1]",buttonPrimary:"bg-amber-700 hover:bg-amber-600 focus:ring-2 focus:ring-amber-500 text-black font-semibold",buttonSecondary:"bg-[#2e1e06] text-amber-300 hover:bg-amber-800 hover:text-white border border-amber-600",title:"text-amber-400",description:"text-amber-400"}};function ey(e){let{open:t,onClose:a,onBlueprintAdded:s}=e,[n,i]=(0,r.useState)("T1"),[o,d]=(0,r.useState)("game"),[c,u]=(0,r.useState)(""),[m,b]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),[g,j]=(0,r.useState)(1),[v,N]=(0,r.useState)(""),[_,T]=(0,r.useState)(""),[E,O]=(0,r.useState)(!1),[P,M]=(0,r.useState)(null),[I,A]=(0,r.useState)(!1),z=eN[n],R="T2"===n&&"game"===o,B=(0,r.useMemo)(()=>{let e=c.trim().split("\n"),t=m.trim().split("\n"),a={},l="",s="",r=!0;function n(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?"Invention Materials / Uncategorized":"Uncategorized",i=!1;for(let u=0;u<e.length;u++){var o,d,c;let x=e[u].trim();if(!x)continue;if(r&&!t){let[e,t]=x.split("	");l=null==e?void 0:e.replace("Blueprint","").trim(),s=null==t?void 0:t.trim(),r=!1;continue}if(/^(Items|Minerals|Components|Planetary materials|Datacores|Optional items)$/i.test(x)){if(n=t?"Invention Materials / ".concat(x):x,"Optional items"===x&&t&&(null==(o=e[u+2])?void 0:o.startsWith("No item selected"))){u+=2;continue}a[n]=[],i=!1;continue}if(/^Item\tRequired\tAvailable\tEst\..*price\ttypeID$/i.test(x)){i=!0;continue}if(!i)continue;let[m,b,p,g]=x.split("	"),f=parseInt(b),j=parseFloat(g);if(m&&!isNaN(f)){let e=t&&h?isNaN(j)?void 0:j/(parseFloat(h)>1?parseFloat(h)/100:parseFloat(h)):isNaN(j)?void 0:j;null!=a[d=n]||(a[d]=[]),a[n].push({name:m.trim(),quantity:f,unitPrice:e})}}}n(e),R&&n(t,!0);let i={};for(let[e,t]of(l&&s&&(i["Blueprint Info"]=[{name:"Name: ".concat(l),quantity:0},{name:"Type ID: ".concat(s),quantity:0}]),h&&R&&(i["Invention Metadata"]=[{name:"Invention Chance: ".concat(h,"%"),quantity:0}]),Object.entries(a)))e in i||(i[e]=t);return i},[c,m,h,R]);async function L(e){e.preventDefault(),O(!0),M(null),A(!1);try{let e=await fetch("/api/blueprints/blueprints",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({blueprint_paste:c,invention_materials:m,sell_price:parseFloat(v)||0,material_cost:parseFloat(_)||0,tier:n,invention_chance:h?parseFloat(h):null,runs_per_copy:"T2"===n?g:null})});if(!e.ok){let t=await e.json();throw Error(t.error||"Unknown error")}A(!0),setTimeout(()=>a(),1500)}catch(e){console.error("Error adding blueprint:",e),M(e.message||"Failed to add blueprint")}finally{null==s||s(),console.log("Added blueprint data:",c),O(!1)}}return(0,l.jsx)(f,{open:t,onOpenChange:e=>!e&&a(),children:(0,l.jsxs)(y,{className:eN[n].modal+" w-full max-w-2xl scale-110 max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)(w,{className:"mb-4",children:[(0,l.jsx)(S,{className:eN[n].title+" text-lg font-semibold",children:"Add Blueprint"}),(0,l.jsx)(k,{className:z.description,children:"Paste in your blueprint data from game or ISK/hour"})]}),(0,l.jsxs)("form",{onSubmit:L,className:"space-y-6",children:[(0,l.jsxs)("div",{className:z.label+" flex gap-4",children:[(0,l.jsxs)(F,{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"radio",checked:"game"===o,onChange:()=>d("game")})," From Game"]}),(0,l.jsxs)(F,{className:eN[n].label,children:[(0,l.jsx)("input",{type:"radio",checked:"isk"===o,onChange:()=>d("isk")})," From ISK/Hour"]})]}),"game"===o&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(eb,{value:n,onValueChange:e=>i(e),className:"flex gap-4 ".concat(z.label),children:[(0,l.jsxs)(F,{htmlFor:"T1",className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,l.jsx)(eh,{id:"T1",value:"T1",className:"border-blue-500 data-[state=checked]:bg-blue-400 data-[state=checked]:ring-2 data-[state=checked]:ring-blue-500"}),"T1"]}),(0,l.jsxs)(F,{htmlFor:"T2",className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,l.jsx)(eh,{id:"T2",value:"T2",className:"border-amber-500 data-[state=checked]:bg-amber-400 data-[state=checked]:ring-2 data-[state=checked]:ring-amber-500"}),"T2"]})]}),(0,l.jsx)(eu,{placeholder:"Paste blueprint data from game",value:c,onChange:e=>u(e.target.value),className:"".concat(z.input," placeholder:").concat(z.label," min-h-[120px] resize-y ")}),R&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eu,{placeholder:"Paste invention materials",value:m,onChange:e=>b(e.target.value),className:"".concat(z.input," placeholder:").concat(z.label)}),(0,l.jsx)(C,{placeholder:"Invention chance % (e.g. 42.5)",value:h,onChange:e=>{let t=e.target.value;""!==t&&isNaN(parseFloat(t))||p(t)},className:"".concat(z.input," placeholder:").concat(z.label)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"blueprintParseRunsPerCopy",className:z.label,children:"Runs per Invented Copy"}),(0,l.jsx)("div",{className:"mt-2"}),(0,l.jsxs)("select",{id:"blueprintParseRunsPerCopy",name:"blueprintParseRunsPerCopy",value:g,onChange:e=>j(Number(e.target.value)),className:"".concat(z.selectTrigger," ").concat(z.dropdown," h-10 pl-4"),children:[(0,l.jsx)("option",{className:z.dropdownItem,value:10,selected:!0,children:"10 Runs"}),(0,l.jsx)("option",{className:z.dropdownItem,value:1,children:"1 Run"})]})]})]})]}),"isk"===o&&(0,l.jsx)(eu,{placeholder:"Paste ISK/hour format material list here",value:c,onChange:e=>u(e.target.value),className:"".concat(z.input," placeholder:").concat(z.label," min-h-[120px] resize-y")}),Object.keys(B).length>0&&(0,l.jsxs)("div",{className:"".concat(z.input," rounded-lg p-4 text-sm"),children:[(0,l.jsx)("strong",{className:"block mb-2 ".concat(z.title),children:"Parsed Preview:"}),(0,l.jsxs)(ej,{className:"h-80 pr-2",children:[Object.entries(B).map(e=>{let[t,a]=e;return(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("div",{className:"".concat(z.title," font-semibold mb-1"),children:t}),(0,l.jsxs)("ul",{className:"".concat(z.label," space-y-1"),children:[a.map(e=>{let{name:a,quantity:s,unitPrice:r}=e;return(0,l.jsx)("li",{className:"".concat(z.li," flex justify-between"),children:"Blueprint Info"===t||"Invention Metadata"===t?(0,l.jsx)("span",{className:z.li,children:a}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:z.li,children:a}),(0,l.jsxs)("span",{className:z.li,children:[s," ",void 0!==r?"\xd7 ".concat(r.toLocaleString(void 0,{maximumFractionDigits:0})," ISK"):""]})]})},a)}),"Blueprint Info"!==t&&"Invention Metadata"!==t&&(0,l.jsxs)("li",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:z.description,children:"Total:"}),(0,l.jsxs)("span",{className:z.label,children:[a.reduce((e,t)=>{let{quantity:a,unitPrice:l}=t;return e+a*(null!=l?l:0)},0).toLocaleString(void 0,{maximumFractionDigits:0})," ISK"]})]})]})]},t)}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("strong",{className:"block mb-2 ".concat(z.title),children:"Est. Price:"}),(0,l.jsxs)("span",{className:z.label,children:[Object.values(B).reduce((e,t)=>e+t.reduce((e,t)=>{let{quantity:a,unitPrice:l}=t;return e+a*(null!=l?l:0)},0),0).toLocaleString(void 0,{maximumFractionDigits:0})," ISK"]})]})]})]}),P&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[(0,l.jsx)(ep.A,{className:"w-4 h-4"}),P]}),I&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-green-400 text-sm",children:[(0,l.jsx)(eg.A,{className:"w-4 h-4"}),"Blueprint added successfully!"]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsx)(C,{placeholder:"Sell Price (Leave as 0 for auto)",value:v,onChange:e=>N(e.target.value),className:"".concat(z.input," placeholder:").concat(z.label)}),(0,l.jsx)(C,{placeholder:"Make Cost (Leave as 0 for auto)",value:_,onChange:e=>T(e.target.value),className:"".concat(z.input," placeholder:").concat(z.label)})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,l.jsx)(x,{type:"submit",className:eN[n].buttonPrimary,disabled:E,children:E?"Adding...":"Add Blueprint"}),(0,l.jsx)(x,{type:"button",variant:"secondary",className:eN[n].buttonSecondary,onClick:a,children:"Cancel"})]})]})]})})}let ew=(0,i.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function e_(e){let{className:t,variant:a,...s}=e;return(0,l.jsx)("div",{"data-slot":"alert",role:"alert",className:c(ew({variant:a}),t),...s})}function eS(e){let{className:t,...a}=e;return(0,l.jsx)("div",{"data-slot":"alert-description",className:c("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}let ek=async(e,t)=>{t(!0);try{console.log("MSW ready. Requesting /api/blueprints/blueprints. Fetching blueprints...");let t=await fetch("/api/blueprints/blueprints");if(!t.ok)throw Error("Failed to fetch blueprints");let a=await t.json();return e(a),console.log("Fetched blueprints:",a),a}catch(e){return console.error("Fetch error:",e),s.oR.error("Failed to load blueprints"),[]}finally{t(!1)}};function eC(){let[e,t]=(0,r.useState)(!1),[a,n]=(0,r.useState)(null),[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(!1),[b,h]=(0,r.useState)([]),[p,g]=(0,r.useState)(null),[f,j]=(0,r.useState)("");async function v(e){try{if(!(await fetch("/api/blueprints/blueprint/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to update blueprint");s.oR.success("Blueprint updated");let a=(await ek(h,m)).find(t=>t.id===e.id);n(null!=a?a:null),t(!1),n(null)}catch(e){console.error("Error updating blueprint:",e)}}async function N(e){try{let t=await fetch("/api/blueprints/blueprints",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to add blueprint");let a=await t.json();a.message?s.oR.success(a.message):s.oR.error(a.error)}catch(e){console.error(e),alert("Failed to update blueprint")}}(0,r.useEffect)(()=>{console.log("Blueprints state changed:",b)},[b]);let y=async()=>{j("Updating blueprint prices..."),document.title="Updating blueprint prices...";try{let e=await fetch("/api/blueprints/update_prices",{method:"POST",headers:{"Content-Type":"application/json"}});if(e.ok){let t=await e.json();j(t.message||"Prices updated successfully!"),ek(h,m),document.title="Eve Manufacturing Optimizer"}else{let t=await e.json();j(t.error||"Failed to update prices.")}}catch(e){j("Error updating prices: "+e)}};return(0,r.useEffect)(()=>{ek(h,m)},[]),(0,l.jsxs)(I,{className:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full ",children:[(0,l.jsx)(A,{className:"px-6 pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,l.jsx)(z,{className:"text-2xl text-blue-100",children:"Blueprints Overview"}),(0,l.jsx)(R,{className:"text-blue-400",children:"View and Manage Blueprints"})]}),(0,l.jsx)(x,{onClick:()=>o(!0),className:"bg-gradient-to-r from-blue-700 via-blue-900 to-blue-800 text-white hover:from-blue-800 hover:to-blue-900 relative top-[10px] left-[-35px] scale-125",children:"+ Add Blueprints"})]})}),(0,l.jsx)(ee,{onEdit:function(e,a){n(e),c(a),t(!0)},blueprints:b,onSetBlueprints:h,loading:u,fetchBlueprints:()=>ek(h,m)}),(0,l.jsxs)("div",{className:"flex flex-col items-center gap-2 px-6 pt-4",children:[(0,l.jsx)(x,{id:"update-blueprints-btn",className:"w-fit text-sm bg-blue-700 hover:bg-blue-800 mx-auto",onClick:y,children:"Update All Blueprint Prices (Cost and Sell)"}),f&&(0,l.jsx)(e_,{className:"   w-full   flex   justify-center   items-center   text-blue-300   font-semibold   bg-blue-950/60   border border-blue-700   rounded-xl   py-2   mt-2   shadow-lg   animate-in fade-in   text-center   ",children:(0,l.jsx)(eS,{className:"w-full text-center justify-center text-blue-300",children:f})})]}),(0,l.jsx)(ec,{open:e,blueprint:a,tier:d,onClose:()=>t(!1),onSave:v}),(0,l.jsx)(ey,{open:i,onClose:()=>o(!1),onSubmit:N,onBlueprintAdded:()=>{console.log("\uD83D\uDD01 Running fetchBlueprints after add"),ek(h,m)}})]})}var eT=a(1154);function eF(e){let{materials:t,loading:a,onEdit:s,onDelete:r}=e,n={};for(let e of t){let t=e.category||"Other";n[t]||(n[t]=[]),n[t].push(e)}return(0,l.jsx)("div",{className:"space-y-6",children:a?(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-blue-300 animate-pulse",children:[(0,l.jsx)(eT.A,{className:"w-5 h-5 animate-spin"}),(0,l.jsx)("span",{children:"Loading materials..."})]}):0===Object.keys(n).length?(0,l.jsx)("p",{className:"text-sm text-blue-300 italic",children:"No materials found."}):(0,l.jsx)(U,{type:"multiple",className:"w-full space-y-4",children:Object.entries(n).sort((e,t)=>{let[a]=e,[l]=t;return a.localeCompare(l)}).map(e=>{let[t,a]=e;return(0,l.jsxs)(q,{value:t,className:"rounded-2xl border border-blue-800 bg-gradient-to-br from-blue-950 via-slate-900 to-slate-950 shadow-lg",children:[(0,l.jsx)(J,{className:"px-4 py-3 text-left text-lg font-semibold text-blue-200 hover:no-underline hover:text-blue-300",children:t}),(0,l.jsx)(V,{className:"px-4 pb-4 space-y-3",children:a.map(e=>(0,l.jsxs)("div",{className:"flex justify-between items-center bg-slate-900/70 hover:bg-blue-900/60 border border-blue-800 rounded-xl px-4 py-2 shadow-sm transition-all",children:[(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{className:"font-semibold text-blue-100",children:e.name}),(0,l.jsxs)("span",{className:"text-sm text-blue-300",children:[e.quantity.toLocaleString()," units"]})]}),(0,l.jsxs)("div",{className:"space-x-2",children:[(0,l.jsx)(x,{size:"sm",className:"bg-blue-700 hover:bg-blue-600 shadow-md hover:shadow-blue-500/30 text-white",onClick:()=>s(e),children:"Edit"}),(0,l.jsx)($,{onDelete:()=>r(e.id),children:"Delete"})]})]},e.id))})]},t)})})})}function eE(e){let{material:t,open:a,onClose:s,onSave:n}=e,[i,o]=(0,r.useState)(0),[d,c]=(0,r.useState)(),[u,m]=(0,r.useState)("Other"),[b,h]=(0,r.useState)("");async function p(e){e.preventDefault(),t&&n({...t,quantity:i,type_id:d,category:"Other"===u?b:u})}return(0,r.useEffect)(()=>{if(t){var e;o(t.quantity),c(null!=(e=t.type_id)?e:void 0),m(t.category||"Other"),h("")}},[t]),(0,l.jsx)(f,{open:a,onOpenChange:s,children:(0,l.jsxs)(y,{className:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full",children:[(0,l.jsx)(w,{children:(0,l.jsxs)(S,{className:"text-blue-300",children:["Edit Material",t?": ".concat(t.name):""]})}),(0,l.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,l.jsx)(C,{type:"number",placeholder:"Quantity",value:i,onChange:e=>o(Number(e.target.value)),required:!0,className:"bg-slate-900 border border-slate-700 text-blue-100"}),(0,l.jsx)(C,{type:"number",placeholder:"Type ID (optional)",value:null!=d?d:"",onChange:e=>c(Number(e.target.value)),className:"bg-slate-900 border border-slate-700 text-blue-100"}),(0,l.jsxs)(el,{value:u,onValueChange:m,children:[(0,l.jsx)(er,{className:"bg-slate-900 border border-slate-700 text-blue-100",children:(0,l.jsx)(es,{placeholder:"Select category"})}),(0,l.jsxs)(en,{className:"bg-slate-800 text-blue-100",children:[(0,l.jsx)(ei,{value:"Minerals",children:"Minerals"}),(0,l.jsx)(ei,{value:"Items",children:"Items"}),(0,l.jsx)(ei,{value:"Components",children:"Components"}),(0,l.jsx)(ei,{value:"Invention Materials",children:"Invention Materials"}),(0,l.jsx)(ei,{value:"Reaction Materials",children:"Reaction Materials"}),(0,l.jsx)(ei,{value:"Planetary Materials",children:"Planetary Materials"}),(0,l.jsx)(ei,{value:"Other",children:"Other"})]})]}),"Other"===u&&(0,l.jsx)(C,{type:"text",placeholder:"Enter custom category",value:b,onChange:e=>h(e.target.value),className:"bg-slate-900 border border-slate-700 text-blue-100"}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,l.jsx)(x,{type:"submit",className:"bg-blue-700 hover:bg-blue-800 text-white",children:"Save"}),(0,l.jsx)(x,{type:"button",variant:"secondary",className:"bg-slate-700 text-blue-200",onClick:s,children:"Cancel"})]})]})]})})}function eO(e){let{open:t,onClose:a,onSubmit:s}=e,[n,i]=(0,r.useState)(""),[o,d]=(0,r.useState)("add"),[c,u]=(0,r.useState)(!1),[m,b]=(0,r.useState)(null),[h,p]=(0,r.useState)(!1),g=(0,r.useMemo)(()=>n.trim().split("\n").map(e=>{let[t,a]=e.split("	"),l=parseInt(a);return t&&!isNaN(l)?{name:t.trim(),quantity:l}:null}).filter(e=>null!==e),[n]);async function j(e){if(e.preventDefault(),b(null),p(!1),!g.length)return;let t={};g.forEach(e=>{let{name:a,quantity:l}=e;t[a]=l}),u(!0);try{let e=await fetch("/api/materials/update_materials",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materials:t,updateType:o})});if(!e.ok){let t=await e.json();throw Error(t.error||"Unknown error")}i(""),d("add"),p(!0),s({materialsText:n,updateType:o}),setTimeout(()=>a(),1500)}catch(e){console.error("Error submitting materials:",e),b(e.message||"Failed to submit materials")}finally{u(!1)}}return(0,l.jsx)(f,{open:t,onOpenChange:e=>!e&&a(),children:(0,l.jsxs)(y,{className:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full max-w-lg",children:[(0,l.jsx)(w,{children:(0,l.jsx)(S,{className:"text-blue-300 text-lg font-semibold",children:"Add Available Materials From Game (Copy/Paste)"})}),(0,l.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,l.jsx)(eu,{placeholder:"Paste available materials here",required:!0,value:n,onChange:e=>i(e.target.value),className:"bg-slate-900 border border-slate-700 text-blue-100 placeholder:text-blue-400 resize-y min-h-[120px]"}),(0,l.jsxs)(eb,{defaultValue:"add",value:o,onValueChange:e=>d(e),className:"flex flex-col gap-4 text-blue-200",children:[(0,l.jsxs)(F,{htmlFor:"addToMaterials",className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,l.jsx)(eh,{id:"addToMaterials",value:"add",className:"border-blue-500 data-[state=checked]:bg-blue-400 data-[state=checked]:border-blue-200"}),"Add to existing materials (Replaces materials with the same name)"]}),(0,l.jsxs)(F,{htmlFor:"replaceMaterials",className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,l.jsx)(eh,{id:"replaceMaterials",value:"replace",className:"border-blue-500 data-[state=checked]:bg-blue-400 data-[state=checked]:border-blue-200"}),"Replace ALL materials (Deletes all existing materials)"]})]}),g.length>0&&(0,l.jsxs)("div",{className:"bg-slate-900 border border-slate-700 rounded-lg p-4 text-sm text-blue-200",children:[(0,l.jsx)("strong",{className:"block mb-2 text-blue-400",children:"Parsed Preview:"}),(0,l.jsx)(ej,{className:"h-40 pr-2",children:(0,l.jsx)("ul",{className:"space-y-1",children:g.map(e=>{let{name:t,quantity:a}=e;return(0,l.jsxs)("li",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:t}),(0,l.jsx)("span",{className:"text-blue-300",children:a})]},t)})})})]}),m&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[(0,l.jsx)(ep.A,{className:"w-4 h-4"}),m]}),h&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-green-400 text-sm",children:[(0,l.jsx)(eg.A,{className:"w-4 h-4"}),"Materials updated successfully!"]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,l.jsx)(x,{type:"submit",className:"bg-blue-700 hover:bg-blue-800 text-white",disabled:c||!g.length,children:c?"Updating...":"Update Available Materials"}),(0,l.jsx)(x,{type:"button",variant:"secondary",className:"bg-slate-700 text-blue-200 hover:bg-slate-600",onClick:a,disabled:c,children:"Cancel"})]})]})]})})}function eP(){let[e,t]=(0,r.useState)(!1),[a,s]=(0,r.useState)(null),[n,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)([]);function m(){s(null),t(!1)}async function b(e){try{await fetch("/api/materials/material/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),u(t=>t.map(t=>t.id===e.id?e:t)),m()}catch(e){console.error("Error updating material:",e)}}async function h(e){let t=e.materialsText.trim().split("\n").map(e=>{let[t,a]=e.split("	"),l=parseInt(a);return t&&!isNaN(l)?{name:t.trim(),quantity:l}:null}).filter(e=>null!==e),a={};t.forEach(e=>{let{name:t,quantity:l}=e;a[t]=l});try{if(!(await fetch("/api/materials/update_materials",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materials:a,updateType:e.updateType})})).ok)throw Error("Failed to update materials");await g()}catch(e){console.error("Failed to add materials:",e),alert("Failed to update materials")}}async function p(e){try{(await fetch("/api/materials/material/".concat(e),{method:"DELETE"})).ok?(u(t=>t.filter(t=>t.id!==e)),console.log("Material deleted successfully.")):console.error("Failed to delete material.")}catch(e){console.error("Error deleting material:",e)}}let g=async()=>{d(!0);try{let e=await fetch("/api/materials/materials");if(!e.ok)throw Error("Failed to fetch materials");let t=await e.json();u(t),console.log("Fetched materials:",t)}catch(e){console.error("Fetch error:",e)}finally{d(!1)}};return(0,r.useEffect)(()=>{console.log("Materials state changed:",c)},[c]),(0,r.useEffect)(()=>{console.log("Fetching materials..."),g()},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(I,{className:"h-full rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full",children:[(0,l.jsx)(A,{className:"px-6 pb-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,l.jsx)(z,{className:"text-2xl text-blue-100",children:"Available Materials"}),(0,l.jsx)(R,{className:"text-blue-400",children:"View and Manage Materials"})]}),(0,l.jsx)(x,{onClick:()=>i(!0),className:"bg-gradient-to-r from-blue-700 via-blue-900 to-blue-800 text-white hover:from-blue-800 hover:to-blue-900 relative top-[5px] left-[-30px] scale-125",children:"+ Add Materials"})]})}),(0,l.jsx)(B,{className:"space-y-4",children:(0,l.jsx)(U,{type:"single",collapsible:!0,children:(0,l.jsxs)(L.As,{value:"materials",className:"border-none bg-slate-900/60 rounded-xl overflow-hidden",children:[(0,l.jsx)(J,{className:"text-blue-200 text-lg font-bold tracking-wide rounded-xl px-4 py-3 bg-blue-900/80 hover:bg-blue-800/80 hover:no-underline shadow transition-all",children:"View Materials Table (Split by Category)"}),(0,l.jsxs)(V,{className:"bg-slate-900/80 px-2 pb-4 pt-2 rounded-b-xl space-y-4",children:[(0,l.jsx)("p",{id:"update-status",className:"text-sm text-gray-400 text-center"}),(0,l.jsx)(eF,{materials:c,loading:o,onEdit:function(e){s(e),t(!0)},onDelete:p}),(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(x,{id:"update-materials-btn",className:"text-sm bg-blue-700 hover:bg-blue-800",onClick:async()=>{let e=document.getElementById("update-status");e&&(e.textContent="Updating material info...",document.title="Updating material info...");try{let t=await fetch("/api/materials/update_material_info",{method:"POST",headers:{"Content-Type":"application/json"}});if(t.ok){let a=await t.json();e&&(e.textContent=a.message||"Material info updated successfully!"),g(),document.title="EVE Manufacturing Optimizer"}else{let a=await t.json();e&&(e.textContent=a.ERROR||"Failed to update material info.")}}catch(t){e&&(e.textContent="Error updating material info: "+t.message)}},children:"Update Material Info (TypeID and Category)"})})]})]})})})]}),(0,l.jsx)(eO,{open:n,onClose:()=>i(!1),onSubmit:h}),a&&(0,l.jsx)(eE,{material:a,open:e,onClose:m,onSave:b})]})}var eM=a(3568);function eI(e){let{data:t}=e,a=t.true_profit_inventory/t.total_profit*100,s=t.true_profit_jita/t.total_profit*100;function r(e){return e<15?"text-red-400":e<25?"text-orange-400":e<35?"text-lime-400 font-semibold shadow-green-400/30 drop-shadow-sm":e<50?'text-emerald-400 font-semibold shadow-lime-400/40 drop-shadow-md after:content-["⭐️"]':e<70?'text-green-400 font-bold drop-shadow-[0_0_5px_#34d399] after:content-["\uD83C\uDF1F"]':'text-fuchsia-400 font-extrabold drop-shadow-[0_0_6px_#e879f9] after:content-["✨"]'}return(0,l.jsxs)("div",{className:"rounded-2xl bg-gradient-to-br from-blue-950 via-slate-900 to-slate-950 p-6 shadow-xl border border-blue-800 w-full",children:[(0,l.jsx)("h3",{className:"text-2xl text-blue-200 font-bold mb-4",children:"Optimization Summary"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-5 gap-6 text-center text-blue-100",children:[(0,l.jsx)(eA,{title:"Total Sell Value",value:t.total_profit,color:"text-green-400"}),(0,l.jsx)(eA,{title:"True Profit (Jita)",value:t.true_profit_jita,color:"text-blue-400"}),(0,l.jsx)(eA,{title:"True Profit % (Jita)",value:s,isPercent:!0,className:r(s)}),(0,l.jsx)(eA,{title:"True Profit (Inventory)",value:t.true_profit_inventory,color:"text-yellow-400"}),(0,l.jsx)(eA,{title:"True Profit % (Inventory)",value:a,isPercent:!0,className:r(a)})]}),(0,l.jsxs)("div",{className:"mt-4 text-xs text-blue-400 text-center",children:[(0,l.jsxs)("span",{className:"block",children:[(0,l.jsx)("span",{className:"font-bold",children:"True Profit (Jita):"})," Profit if you bought all materials at Jita sell price."]}),(0,l.jsxs)("span",{className:"block",children:[(0,l.jsx)("span",{className:"font-bold",children:"True Profit (Inventory):"})," Profit accounting for your current inventory (only buying what you lack)."]})]})]})}function eA(e){let{title:t,value:a,color:s,isPercent:n,className:i}=e,[o,d]=(0,r.useState)(!1);return(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center bg-slate-800 rounded-xl p-4 shadow-md border border-blue-800 hover:shadow-blue-500/40 hover:border-blue-500 transition duration-300 cursor-pointer",onClick:()=>{d(e=>!e)},title:"Click to toggle value format",children:[(0,l.jsx)("span",{className:"text-sm text-blue-300",children:t}),(0,l.jsx)("span",{className:"text-xl font-semibold transition-all duration-200 ".concat(null!=s?s:""," ").concat(null!=i?i:""),children:n?"".concat(a.toFixed(2),"%"):o?Z(a):"".concat(a.toLocaleString()," ISK")})]})}function ez(e){let{data:t}=e;if(!t||0===Object.keys(t).length)return null;let a=Object.entries(t).sort((e,t)=>e[0].localeCompare(t[0]));return(0,l.jsxs)("div",{className:"rounded-2xl bg-gradient-to-br from-blue-950 via-slate-900 to-slate-950 p-4 shadow-xl border border-blue-800 w-full",children:[(0,l.jsx)("h3",{className:"text-xl text-blue-300 font-semibold",children:"Required Component Production"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left text-blue-100 rounded-lg overflow-hidden border border-blue-800",children:[(0,l.jsx)("thead",{className:"bg-blue-800 text-blue-100",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-2",children:"Component"}),(0,l.jsx)("th",{className:"px-4 py-2",children:"Quantity Needed"})]})}),(0,l.jsx)("tbody",{children:a.map(e=>{let[t,a]=e;return(0,l.jsxs)("tr",{className:"border-t border-blue-800",children:[(0,l.jsx)("td",{className:"px-4 py-1",children:t}),(0,l.jsx)("td",{className:"px-4 py-1",children:a.toLocaleString()})]},t)})})]})})]})}function eR(e){let{data:t}=e,a=Object.entries(t).filter(e=>{let[t,a]=e;return a>0}).sort((e,t)=>e[0].localeCompare(t[0]));return 0===a.length?null:(0,l.jsxs)("div",{className:"rounded-2xl bg-gradient-to-br from-blue-950 via-slate-900 to-slate-950 p-4 shadow-xl border border-blue-800 w-full",children:[(0,l.jsx)("h3",{className:"text-xl text-blue-300 font-semibold",children:"Production Plan"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left text-blue-100 rounded-lg overflow-hidden border border-blue-800",children:[(0,l.jsx)("thead",{className:"bg-blue-800 text-blue-100",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-2",children:"Blueprint"}),(0,l.jsx)("th",{className:"px-4 py-2",children:"Quantity"})]})}),(0,l.jsx)("tbody",{children:a.map(e=>{let[t,a]=e;return(0,l.jsxs)("tr",{className:"border-t border-blue-800",children:[(0,l.jsx)("td",{className:"px-4 py-1",children:t}),(0,l.jsx)("td",{className:"px-4 py-1",children:a.toLocaleString()})]},t)})})]})})]})}var eB=a(3052);let eL=["Tritanium","Pyerite","Mexallon","Isogen","Nocxium","Zydrine","Megacyte","Morphite"],eD=["Minerals","Components","Items","Invention Materials","Reaction Materials","Salvaged Materials","Planetary Materials","Fuel","Other"];function eU(e){let{usage:t}=e,a={},[s,n]=(0,r.useState)(!1);for(let e in t){var i,o;let l=t[e],s=null!=(o=null==(i=l.category)?void 0:i.trim())?o:"Other";eL.includes(e)&&(s="Minerals"),eD.includes(s)||(s="Other"),a[s]||(a[s]={}),a[s][e]=l}return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-2xl text-blue-300 font-semibold mb-2",children:"Material Usage by Category"}),(0,l.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:eD.map(e=>{let t=a[e];if(!t)return null;let r=Object.values(t).filter(e=>e.used>0).length,i=Object.keys(t).length;return(0,l.jsxs)("div",{className:c("rounded-xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border border-blue-800 shadow-md transition-all",s?"ring-2 ring-blue-600 shadow-xl":"hover:ring-1 hover:ring-blue-600"),children:[(0,l.jsxs)("div",{className:"cursor-pointer flex justify-between items-center p-4",onClick:()=>n(!s),children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-lg text-blue-200 font-bold",children:e}),(0,l.jsxs)("p",{className:"text-blue-400 text-sm",children:[i," total kind(s) of ",e," — ",r," used"]})]}),(0,l.jsx)("div",{className:"text-blue-400",children:s?(0,l.jsx)(D.A,{}):(0,l.jsx)(eB.A,{})})]}),s&&(0,l.jsxs)("div",{className:"px-4 pb-4 space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between text-xs text-blue-300 font-semibold border-b border-blue-800 pb-1",children:[(0,l.jsx)("div",{className:"w-1/3",children:"Material"}),(0,l.jsx)("div",{className:"w-1/4 text-right",children:"Used"}),(0,l.jsx)("div",{className:"w-1/4 text-right",children:"Remaining"}),(0,l.jsx)("div",{className:"w-1/5 text-right",children:"Used %"})]}),Object.entries(t).sort((e,t)=>e[0].localeCompare(t[0])).map(e=>{let[t,a]=e,s=a.used+a.remaining,r=s>0?a.used/s*100:0,n=r>=200?"text-red-900":r>=180?"text-red-800":r>=160?"text-red-700":r>=140?"text-red-600":r>=120?"text-red-500":r>=100?"text-red-400":r>=90?"text-red-300":r>=70?"text-orange-400":r>=50?"text-yellow-500":r>=30?"text-green-300":"text-green-400",i=Math.min(r,100);return(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm text-blue-100",children:[(0,l.jsx)("div",{className:"w-1/3 truncate",children:t}),(0,l.jsx)("div",{className:"w-1/4 text-rose-400 text-right",children:a.used.toLocaleString()}),(0,l.jsx)("div",{className:c("w-1/4 text-right",n),children:a.remaining.toLocaleString()}),(0,l.jsxs)("div",{className:"w-1/5 text-right ".concat(n),children:[r.toFixed(1),"%"]})]}),(0,l.jsx)("div",{className:"h-1 bg-slate-800 rounded overflow-hidden",children:(0,l.jsx)("div",{className:c("h-full transition-all duration-300 ease-in-out",r>=200?"bg-red-900":r>=180?"bg-red-800":r>=160?"bg-red-700":r>=140?"bg-red-600":r>=120?"bg-red-500":r>=100?"bg-red-400":r>=90?"bg-red-300":r>=70?"bg-orange-400":r>=50?"bg-yellow-500":r>=30?"bg-green-300":"bg-green-400"),style:{width:"".concat(i,"%")}})})]},t)})]})]},e)})})]})}function eq(e){let{materialUsage:t}=e,a=Object.entries(t).map(e=>{let[t,a]=e,l=a.used+a.remaining;return{name:t,percent:l>0?a.used/l*100:0}}).filter(e=>e.percent>90).sort((e,t)=>t.percent-e.percent);return 0===a.length?null:(0,l.jsxs)("div",{className:"rounded-2xl bg-gradient-to-br from-blue-950 via-slate-900 to-slate-950 p-6 shadow-xl border border-blue-800 w-full",children:[(0,l.jsx)("h3",{className:"text-xl text-blue-300 font-semibold mb-4",children:"Bottleneck Materials"}),(0,l.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:a.map(e=>{let{name:t,percent:a}=e;return(0,l.jsxs)("div",{className:"bg-slate-900/80 border border-blue-800 rounded-xl p-4 shadow hover:shadow-blue-700 transition-all duration-300",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsx)("span",{className:"text-blue-100 font-medium",children:t}),(0,l.jsxs)("span",{className:"text-xs font-bold px-2 py-1 rounded-full ".concat(a>=200?"bg-red-900 text-red-100":a>=180?"bg-red-800 text-red-100":a>=160?"bg-red-700 text-red-50":a>=140?"bg-red-600 text-red-50":a>=120?"bg-red-500 text-red-50":a>=100?"bg-red-400 text-red-100":a>=95?"bg-red-300 text-red-900":a>=90?"bg-yellow-400 text-yellow-900":a>=70?"bg-orange-400 text-orange-900":a>=50?"bg-yellow-500 text-yellow-900":a>=30?"bg-green-300 text-green-900":"bg-green-400 text-green-900"),children:[a.toFixed(1),"%"]})]}),(0,l.jsx)("div",{className:"w-full bg-slate-800 rounded-full h-2.5 overflow-hidden",children:(0,l.jsx)("div",{className:"h-full transition-all duration-300 ease-in-out ".concat(a>=200?"bg-red-900":a>=180?"bg-red-800":a>=160?"bg-red-700":a>=140?"bg-red-600":a>=120?"bg-red-500":a>=100?"bg-red-400":a>=95?"bg-red-300":a>=90?"bg-yellow-400":a>=70?"bg-orange-400":a>=50?"bg-yellow-500":a>=30?"bg-green-300":"bg-green-400"),style:{width:"".concat(a,"%")},title:"".concat(a.toFixed(2),"% used")})})]},t)})})]})}function eJ(){let[e,t]=(0,r.useState)(null),[a,s]=(0,r.useState)(!1),n=async()=>{s(!0);try{let e=await fetch("/api/blueprints/optimize");if(!e.ok)throw Error("Failed to optimize");let a=await e.json();t(a),eM.Ay.success("Optimization complete!")}catch(e){console.error("Optimization failed:",e),eM.Ay.error("Failed to optimize: "+e)}finally{s(!1)}},i=null!==e?{total_profit:e.total_profit,true_profit_jita:e.true_profit_jita,true_profit_inventory:e.true_profit_inventory}:null;return(0,l.jsxs)(I,{className:"rounded-2xl bg-gradient-to-br from-slate-900 via-slate-950 to-blue-950 border-blue-800 shadow-2xl w-full p-6",children:[(0,l.jsx)(A,{children:(0,l.jsx)(z,{className:"text-2xl text-blue-100 mb-2",children:"Optimize Production"})}),(0,l.jsxs)(B,{className:"flex flex-col items-center space-y-6",children:[(0,l.jsx)(x,{onClick:n,disabled:a,className:"bg-blue-900 hover:bg-blue-700 text-white font-bold text-lg py-4 px-6 rounded-lg shadow-lg shadow-blue-500/50 transition duration-300 ease-in-out hover:scale-110 hover:shadow-xl",children:a?"Optimizing...":"OPTIMIZE PRODUCTION"}),e&&(0,l.jsxs)("div",{className:"w-full space-y-6",children:[i&&(0,l.jsx)(eI,{data:i}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsx)(ez,{data:e.dependencies_needed}),(0,l.jsx)(eR,{data:e.what_to_produce})]}),(0,l.jsx)(eU,{usage:e.material_usage}),(0,l.jsx)(eq,{materialUsage:e.material_usage})]})]})]})}function eV(){let[e,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{b.then(()=>{console.log("MSW is fully ready, now rendering app"),t(!0)})},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.l$,{position:"top-right",theme:"light",toastOptions:{className:"bg-blue-100 text-blue-900 border border-blue-300 shadow-lg",style:{backgroundColor:"#dbeafe",color:"#1e3a8a",borderColor:"#93c5fd"}}}),(0,l.jsx)(h,{}),(0,l.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4 px-8 py-10 max-w-7xl mx-auto items-stretch",children:[(0,l.jsx)("div",{className:"h-full",children:(0,l.jsx)(K,{})}),(0,l.jsx)("div",{className:"h-full",children:(0,l.jsx)(eP,{})})]}),(0,l.jsx)("div",{className:"px-8 max-w-7xl mx-auto pb-10",children:(0,l.jsx)(eC,{})}),(0,l.jsx)("div",{className:"px-8 max-w-7xl mx-auto pb-10",children:(0,l.jsx)(eJ,{})})]})}},3396:(e,t,a)=>{Promise.resolve().then(a.bind(a,2522))}},e=>{var t=t=>e(e.s=t);e.O(0,[888,441,684,358],()=>t(3396)),_N_E=e.O()}]);